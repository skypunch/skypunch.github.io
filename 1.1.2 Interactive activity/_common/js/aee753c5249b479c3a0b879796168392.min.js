/** @license
 * Activity Builder Copyright (C) 2013-2016 Infuze Ltd <enq@infuze.co.uk>, All Rights Reserved.
 */
require.config({shim:{velocity:["jquery"]},waitSeconds:30}),function(o,n,l){var Un="/",Nt="jquery",ie="activity",Mn="modernizr",Cn="velocity",os="velocity-ui",Ke="common",Xi="_const",ps="api",De="fill_the_gaps",fs=De+Un+De;define("api",[Nt,ie],function(r,a){function g(){}function M(t,e,i,s){try{if(t.apply(i,s)===!1)return!1}catch(t){n.console.error("Exception in API("+e+"): ",t,t.stack)}}function c(t,e){d=d||{},d[t]=e}var u,b,d,y=[],x=a.abcAlwaysModules=a.abcAlwaysModules||{},v=a.abcModulesIndex=a.abcModulesIndex||{},S=a.abcModulesGlobal=a.abcModulesGlobal||{},h=a.abcModules={_data:{}};return a.API=g,g.pause=function(t){t===!0?a._paused=t:(a._paused=!1,a[E]())},g.addModule=n.addModule=function(n,s){if(h[n]=s,s.always&&(x[n]=s),a.api_started){var i,e,r={};for(i=0;a.count>i;i++)r["#activity_"+(i+1)]=a[i][t](["_path"],i);for(b=n,a.api(fi,r),i=0;a.count>i;i++)if(e=a[i],e[Ot]=null,e._loaded){if(a.api(ot,e.baseId,e.doNotMark?{}:e.persistData),!a.loaded)continue;a.CurrentActivity===e.index&&a.api(li,e.baseId),e.doNotMark||a.api(Mt,e.baseId,e.persistData),a.started&&a.CurrentActivity===e.index&&a.api(Dt,e.baseId,null),a.api(ce,e.baseId),a.api(Yt,e.baseId)}b=null}},g.useModule=n.useModule=function(t,l,n){if(!h[t]&&a.commonPath){var s=f+e+t+e+Ie;if(!a.parent.children(At+"[src*='"+s+"']").length){var i=o.createElement("script");i.type=Ce+Je+Pe+At,i.src=a.commonPath+s,a.parent[0].appendChild(i)}}v[t]=v[t]||[],r.currentHandler[m]=r.currentHandler[m]||{},r.currentHandler[m][t]={data:l,index:v[t].length},delete r.currentHandler[Ot],v[t].push(r.currentHandler.baseId),r.isPlainObject(n)&&(h._data[t]=h._data[t]||{},r.extend(!0,h._data[t],n,{name:t}))},a.api=function(o,_,p){if(_&&!(y.indexOf(o)>-1)){var c,l,w,s,t,n,f=[],C=r.currentHandler,i=a[_],g=i instanceof a;g?(r.currentHandler=i,p=[].slice.call(arguments,2),n=i[Ot],n||(n=i[Ot]=r.extend({},x,i[m]))):(i={},p=[].slice.call(arguments,1),n=a.abcModules),y.push(o);for(t in n)n.hasOwnProperty(t)&&r.isPlainObject(h[t])&&h[t][o]&&(!b||b===t)&&f.push(t);for(f.sort(function(t,e){return(h[t].nice||0)-(h[e].nice||0)}),c=0;f.length>c;c++){if(t=f[c],!s){if(s={},g)for(l in d)d.hasOwnProperty(l)&&(s[l]=d[l].bind(i));s.readonly=!!a._readonly,s.ext=e+j,s.setreadonly=function(t){!a._readonly&&t&&(a._readonly=u.readonly=s.readonly=!0)},g&&"load"===o&&(s.removeModule=function(){var e,i,n=this[m][t].index;for(e=0;a.count>e;e++)i=a[e],i[m][t]&&i[m][t].index>n&&i[m][t].index--;delete this[m][t]}.bind(i))}u=r.extend(!0,[],v[t],h._data[t],s,{id:i.baseId,uuid:i.data&&i.data._uuid,global_uuid:a.uuid,type:i.type,_type:i._type,module:t,active:a.handler===i,running:a.loaded}),n[t].hasOwnProperty(Xe)&&(u.index=n[t].index),n[t].hasOwnProperty(wn)?u.data=n[t].data:S[t]&&(u.data=S[t]),M(h[t][o],t+e+o,u,p)===!1&&(w=!1)}return y.pop(),r.currentHandler=C,w}},c(fn,function(t){r.isNumber(t)&&(t="#activity_"+t);for(var e=0;a.count>e;e++)if(a[e].baseId===t)return a[_](e),!0;return!1}),c(Yt,function(){this&&this===a.handler&&a[A]()}),c(pn,function(i,e,n){return this&&JSON.parse(JSON.stringify(this[t](i,e===l?null:e,n)))}),c(Mt,function(t){return this&&JSON.parse(JSON.stringify(this[s](t)))}),c(te,function(t,e){return this&&this.timer(t,e)}),c(R,function(t,e,i){return this&&this[fe](t,e,i)}),c(oe+"_"+q,function(t){return this?this.countLeft(t):0}),c(oe+"_"+sn,function(t){return this?this.countTotal(t):1}),c(oe+"_"+dt,function(t){return this?this.countLeft(t):0}),c(Zt,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableSubmit"],!t),r.isBoolean(e)&&this[w]([i,"hideSubmit"],e),this.initList();else{var n=this._btnSubmit;this._btnSubmit=!0,this.onSubmit(t),this._btnSubmit=n}}),c(Xt,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableReset"],!t),r.isBoolean(e)&&this[w]([i,"hideReset"],e),this.initList();else{var n=this._btnReset;this._btnReset=!0,this.onReset(t),this._btnReset=n}}),c(Ut,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableReveal"],!t),r.isBoolean(e)&&this[w]([i,"hideReveal"],e),this.initList();else{var n=this._btnReveal;this._btnReveal=!0,this.onReveal(t),this._btnReveal=n}}),c(Et,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableFirst"],!t),r.isBoolean(e)&&this[w]([i,"hideFirst"],e),this.initList();else{var n=this._btnFirst;this._btnFirst=!0,this.onFirst(t),this._btnFirst=n}}),c(q,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableLeft"],!t),r.isBoolean(e)&&this[w]([i,"hideLeft"],e),this.initList();else{var n=this._btnLeft;this._btnLeft=!0,this.onLeft(t),this._btnLeft=n}}),c(dt,function(t,e){if(this)if(r.isBoolean(t))this[w]([i,"disableRight"],!t),r.isBoolean(e)&&this[w]([i,"hideRight"],e),this.initList();else{var n=this._btnRight;this._btnRight=!0,this.onRight(t),this._btnRight=n}}),c(hs,function(t){return this&&this[p](t)}),c(Re,function(t,e,i,n){return this&&this.dialog(t,e,i,n)}),g}),define("common",[Nt,Mn,Cn,os],function(i){function r(t,e,n){t[e]||(t[e]=n,(Object.defineProperty||i.noop)(t,e,{enumerable:!1}))}function w(x,p,y,b,v,m,g,f){var s,a,n,c,t,e,u=arguments;for(s=0;u.length>s;s++)if(t=u[s],s||!i.isBoolean(t)&&t)if(e){if(t)if(i.isPlainObject(t))e.css(t);else if(i.isArray(t))t.length&&e[t[0]].apply(e,t.slice(1));else if(i.isString(t))if("#"===t[0])e.attr("id",t.replace("#",""));else if("<"===t[0])e.append(t);else if("="===t[0])e.html(t.substr(1));else{var d=t.indexOf(":"),r=t.indexOf("=");if(d>=0&&(0>r||r>d))for(n=t.regex(/\s*([a-z-]+):(\s*(?:url\([^\)]*\)|[^;]+)+)\s*;?/gi),a=0;n.length>a;a++)e.css(n[a][0],n[a][1]);else r>0?(n=t.regex(/(.*?)=(.*)/),c="?"===t[0],e[c?"data":"attr"](c?n[0].substr(1):n[0],n[1]===l?!0:n[1])):t.length&&e.addClass(t)}else t.jquery&&e.append(t)}else e=i(!i.isString(t)||(/[ #<.]/.test(t)?t:o.createElement(t)));else if(!t)break;return e=e||i(),e.length&&i.currentHandler&&!i.currentHandler._loaded&&i.currentHandler.context&&e.is(rt)&&!e[0].complete&&(i.currentHandler[Rt](),e.on(ot+h+Jn,function(t){this.off(),t[E]()}.bind(e,i.currentHandler))),e}function A(t){var e=parseInt(t%60),i=parseInt(t/60);return i+":"+(e>9?"":"0")+e}var s=i.fn,c=Array.prototype,O=Date.prototype,S=Function.prototype,M=Number.prototype,m=Object.prototype,y=String.prototype;!function(){try{var s,t,e=n.console=n.console||{},a=S.bind,r=["log","warn","error","debug","info","assert","trace"];for(s=0;r.length>s;s++)t=r[s],e[t]=e[t]||i.noop,a&&"object"==typeof e[t]&&(e[t]=a.call(e[t],e))}catch(t){}}();var C=Modernizr.prefixed("requestAnimationFrame",n),x={},_=!1;i.rAF=function(t,s){var e;i.isString(t)?(e=s,s?(x[t]=s,_?e=!1:(_=!0,e=function(){var e;_=!1;for(t in x)x.hasOwnProperty(t)&&(e=x[t],e&&(x[t]=!1,e()))})):x[t]=!1):e=t,e&&(C&&!o.hidden?C(e):n.setTimeout(e,16))},i.log=function(t){var e=n.console;return t&&e&&e.log&&e.log(t),t},i.explode=function(n){var t,e=[];if(n&&i.isArray(n)&&(e=n.slice(0)),i.isString(n))for(e=n.split("."),t=0;e.length-1>t;t++)"\\"===e[t].substr(-1)&&(e[t]=e[t].substr(0,e[t].length-1)+"."+e.splice(t+1,1),t--);for(t=0;e.length>t;t++)/[^\d]/.test(e[t])||(e[t]=parseInt(e[t],10));return e},i.False=function(){return!1},i.True=function(){return!0},i.extend(i.support,{mobile:/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}),i.stylesheet=function(e,n,s){var t,a,r,o=function(i,t,e){n[t]=e};if(i.stylesheet.globalStylesheet||(i.stylesheet.globalStylesheet=i('<style style="text/css"/>').appendTo("head"),i.stylesheet.rules={}),i.stylesheet.globalStylesheet)if(n){if(i.isString(n)&&(n.indexOf("{")>=0&&(n=n.replace(/(^[^{]*\{|\}.*)/g,"")),n=n.split(";")),i.isArray(n))for(a=n,n={},t=0;a.length>t;t++)i.isString(a[t])&&a[t].replace(/^\s*([^\s:]+)\s*:\s*(.*?)\s*$/,o);for(e=i.isArray(e)?e:e.split(","),s=i.isString(s)?s+" ":"",t=0;e.length>t;t++)e[t]=s+e[t].trim();for(t=0;e.length>t;t++)r=e[t],i.stylesheet.rules[r]=i.extend(i.stylesheet.rules[r]||{},n);i.rAF("style",i.stylesheet.update)}else if(i.isString(e)&&/\{.*?\}/.test(e))for(e=e.regex(/\s*(.*?)\s*\{([^\}]*)\}/g),t=0;e.length>t;t++)i.stylesheet(e[t][0],e[t][1],s);else if(i.isPlainObject(e))for(t in e)e.hasOwnProperty(t)&&i.stylesheet(t,e[t],s);return this},i.stylesheet.update=function(){if(i.stylesheet.globalStylesheet){var t,a,e,n,r=i.stylesheet.rules,s="";for(e in r)if(r.hasOwnProperty(e)){s+=e+"{",n=r[e];for(t in n)n.hasOwnProperty(t)&&(a=i.camelCase(t),s+=("float"!==t&&i.cssProps.hasOwnProperty(a)?i.cssProps[a].replace(/([A-Z])/g,"-$1").toLowerCase():t)+":"+n[t]+";");s+="}"}i.stylesheet.globalStylesheet.text(s)}},i.stylesheet.empty=function(){return i.stylesheet.globalStylesheet&&(i.stylesheet.rules={},i.stylesheet.globalStylesheet.text("")),this},s.onFontLoaded=function(t,e){return i.isFunction(t)?this.each(function(r,a){var i=w(u,"ui-font-loader","font-family:sans-serif",[Ce,"giItT1WQy@!-/#"]).appendTo(a);n.setTimeout(s.onFontLoaded.check.bind(i,0,i.width(),i.height(),t),s.onFontLoaded.defaults.delay),i.css(et,e||"inherit")}):this},s.onFontLoaded.check=function(t,e,i,a){e!==this.width()||i!==this.height()||t>=s.onFontLoaded.defaults.maximum?(this.remove(),a()):n.setTimeout(s.onFontLoaded.check.bind(this,t+1,e,i,a),s.onFontLoaded.defaults.delay)},s.onFontLoaded.defaults={delay:50,maximum:40},s.fixNatural=function(){return this.each(function(e,i){if(this.naturalWidth===l){var t=new Image;t.src=this.src,this.naturalWidth=t.width,this.naturalHeight=t.height}})},s.naturalWidth=function(){return this.length?this[0].naturalWidth||this.fixNatural()[0].naturalWidth:null},s.naturalHeight=function(){return this.length?this[0].naturalHeight||this.fixNatural()[0].naturalHeight:null},s.slideTo=function(e,t){var n=!e||e===un,s=n?null:i(e);return n||s.length?this.each(function(){var e=i(this),a=e.offset();n||s.is(e.parent())||e.appendTo(s),e.velocity("stop",!0),0===t||i.isPlainObject(t)&&0===t.duration?e.css({top:0,left:0}):e.offset(a).velocity({top:0,left:0},t)}):this},s.findTextSize=function(b){var l,e,r,c,h,u,d,f,p,m=this.length,n=i.extend({},s.findTextSize.defaults,b),y=n.maxWidth||0,g=n.maxHeight||0,a=n.maxSize||200,o=n.minSize||50,t=a,x=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1};if(o!==a)for(l=0;m>l;l++){for(e=this.get(l),r=x(2*Math.ceil(a-o)),c=i.isString(n.useParent)?i(e).closest(n.useParent):i(n.useParent?e.parentNode:e),d=Math.ceil(y||c.width()),f=Math.ceil(g||c.height()),h=i(e).style({overflow:v,maxWidth:d+Kt,maxHeight:kt,width:Ft,height:Ft,fontSize:"1px"}),p=h.find(":css("+Ti+"="+Ui+")").filter(":visible").not(e).style({display:kt}),u=o;r>.1;)if(r/=2,t=Math.min(a,t+r),e.style.fontSize=t+"%",d>=e.scrollWidth&&f>=e.scrollHeight){if(t===a)break;u=t}else{if(!(t>o))break;t=u}a=t,h.style(),p.style()}return t},s.findTextSize.defaults={useParent:!0,maxWidth:0,maxHeight:0,minSize:50,maxSize:200},s.autoTextSize=function(t){return this.css("font-size",this.findTextSize(t)+"%")},s.wrapGroup=function(n){for(var e,t=i(this);t.length;)e=t.first(),e.nextAll().each(function(i){return t.eq(i+1).is(this)?(e.push(this),l):!1}),t=t.not(e.wrapAll(n));return this},s.textSpace=function(){var t="";return i(this).find("*").contents().each(function(){3===this.nodeType&&(t+=(t?" ":"")+this.textContent)}),t},i.prefix=function(t){return t.indexOf("-")>=0&&(t=t.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()})),i.cssProps[t]||(i.cssProps[t]=Modernizr.prefixed(t)),i.cssProps[t]},s.style=function(s){var t,a,r,n,e,o="savedStyles";for(n=0;this.length>n;n++)if(r=this.get(n).style,e=this[o+n],i.isArray(s))for(e||(e=this[o+n]={}),t=0;s.length>t;t++)a=i.prefix(s[t]),e[a]=r[a];else if(i.isPlainObject(s)){e||(e=this[o+n]={});for(t in s)s.hasOwnProperty(t)&&(a=i.prefix(t),e[a]=r[a],r[a]=s[t])}else if(e){for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);delete this[o+n]}return this},s.verticalCenter=function(e){var n=i.isString(e),t=[];return this.each(function(r,a){var e=i(a),s=((n?i(s,a).height():s||e.parent().height())-e.height())/2,o=parseFloat(e.css("font-size"));t[r]=Math.max(0,s/o)}).each(function(e,n){i(n).css("padding-top",t[e]+"em")}),this},s.getRect=function(){var e=this[0];if(e){var t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,height:t.height||t.bottom-t.top,width:t.width||t.right-t.left}}},s.min=function(e,n){var t=Number.MAX_VALUE;return this.each(function(s,n){t=Math.min(t,parseFloat(i(n).css(e)))}),(t===Number.MAX_VALUE?n:t)||0},s.max=function(e,n){var t=Number.MIN_VALUE;return this.each(function(s,n){t=Math.max(t,parseFloat(i(n).css(e)))}),(t===Number.MIN_VALUE?n:t)||0},s.rxRemoveClass=function(i){var t,e;for(t=0;this.length>t;t++)e=this.eq(t),e.removeClass((e.attr("class")||"").regex(i));return this},s.drawLine=function(e,l){var n=function(e,t,i,s,a,r,n){return e+(n?t/4:0)>i+s?a:i>e+(n?t/4*3:t)?r:"center"},a=function(r,o,e,s,a){var t=r.getBoundingClientRect(),i=o.getBoundingClientRect();t.height=t.height||t.bottom-t.top,t.width=t.width||t.right-t.left,e=e.split(" "),e[1]=e[1]||e[0],"auto"===e[0]&&(i.width=i.width||i.right-i.left,e[0]=n(t.left,t.width,i.left,i.width,"left","right",s)),"auto"===e[1]&&(i.height=i.height||i.bottom-i.top,e[1]=n(t.top,t.height,i.top,i.height,"top","bottom",s)),s||-1!==e.indexOf("center")||(e[t.height>t.width?0:1]="center");var l={left:("left"===e[0]?t.left:"right"===e[0]?t.right:t.width/2+t.left)-a.left,top:("top"===e[1]?t.top:"bottom"===e[1]?t.bottom:t.height/2+t.top)-a.top};return l},r=function(i){var t=i.data(T+"-options"),s=i.offsetParent()[0].getBoundingClientRect(),e=a(t.parent,t.target,t.from,t.corners,s),n=a(t.target,t.parent,t.to,t.corners,s);i.css({top:e.top-parseFloat(i.css("padding-top"))+"px",left:e.left-parseFloat(i.css("padding-left"))+"px",width:Math.sqrt(Math.pow(e.left-n.left,2)+Math.pow(e.top-n.top,2))+"px",transform:"rotate("+Math.atan2(n.top-e.top,n.left-e.left)+"rad)"})};if("destroy"===e)return this.each(function(s,e){var t=i(e),n=t.data(T+"-options");n||t.data(T)&&(t.data(T).remove(),t.removeData([T]))});if(!e||e===ge)return this.each(function(s,e){var t=i(e),n=t.data(T+"-options");n?r(t):t.data(T)&&t.data(T).drawLine(ge)});if(e.length){var o=i(e),t=i.extend({},s.drawLine.options,l);return this.each(function(a,c){var a,n,h,s,l=i(c),u=t.source?i(t.source,l)[0]:c,e=l.data(T)||i();for(t.replace&&(e.remove(),e=i()),u||(u=c),a=0;o.length>a;a++){for(h=o[a],n=0;e.length>n&&(s=e.eq(n),s.data(T+"-options").target!==h);n++);n===e.length&&(s=i('<hr class="ui-helper-reset ui-line">').data(T+"-options",{target:h,from:t.from,parent:u,to:t.to,corners:t.corners}).appendTo(l),e.push(s[0]),l.data(T,e)),r(s)}})}return this},s.drawLine.options={source:null,corners:!0,from:"center",to:"center",replace:!0},s.insertAt=function(e,s){var n,t=i(s);for(e>0&&(t=t.children().eq(e-1)),n=this.length-1;n>=0;n--)0>=e?t.prepend(this):t.after(this);return this},s.modal=function(n,t){return t=t===!0?400:t,this.each(function(c,o){var a=!0,r=i(o),s=r.data(Vt);n===l?a=s===l:i.isBoolean(n)&&(a=n),a&&!s?(s=w(u,Wt+h+"ui-widget-overlay",t?"ui-widget-slow":null,t?Mi+":0":null),r.before(s).addClass(Wt).data(Vt,s),i(Y+f+Qe+e+yt).addClass(d),t&&s.velocity("fadeIn",t)):!a&&s&&(t=t||s.hasClass("ui-widget-slow"),r.removeClass(Wt).removeData(Vt),i(Y+f+Qe+e+yt).removeClass(d),t?s.velocity("fadeOut",t,function(){i(this).remove()}):s.remove())})},s.hoverable=function(t){return this.hover(function(){i(this).addClass(t||gi)},function(){i(this).removeClass(t||gi)})},s.family=function(){var e,t,n=i();for(e=0;this.length>e;e++)for(t=this[e];t!==o;t=t.parentNode)n.push(t);return n},s.common=function(t){if(t&&this.is(t))return this;var e,n=(t?this:this.eq(0)).family(),s=t?i(t):this.slice(1);for(e=0;s.length>e;e++)n=n.has(s.eq(e).family());return n},s.commonFirst=function(t){return this.common(t).first()},s.maxHeight=function(){var t,e=0;for(t=0;this.length>t;t++)e=Math.max(e,this.eq(t).height());return e},s.maxWidth=function(){var t,e=0;for(t=0;this.length>t;t++)e=Math.max(e,this.eq(t).width());return e},s.shuffle=function(t){return t===!1?this:[].shuffle.call(i(this))},s.imageLoad=function(t,e){return this.each(function(){var n=i(this),s=this.complete;s&&t.call(this,n),(!s||e)&&n[e?"on":"one"](ot,t.bind(this,n))})},function(){function c(t,e,i){return[parseFloat(t[0])*(h.test(t[0])?e/100:1),parseFloat(t[1])*(h.test(t[1])?i/100:1)]}function a(t,e){return parseInt(i.css(t,e),10)||0}function g(t){var e=t[0];return 9===e.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:i.isWindow(e)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}i.ui=i.ui||{};var r,e=Math.max,t=Math.abs,o=Math.round,u=/left|center|right/,d=/top|center|bottom/,f=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,h=/%$/,m=s.position;i.position={scrollbarWidth:function(){if(r!==l)return r;var n,e,t=i("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=t.children()[0];return i("body").append(t),n=s.offsetWidth,t.css("overflow","scroll"),e=s.offsetWidth,n===e&&(e=t[0].clientWidth),t.remove(),r=n-e},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),s="scroll"===e||"auto"===e&&t.element[0].scrollWidth>t.width,a="scroll"===n||"auto"===n&&t.element[0].scrollHeight>t.height;return{width:a?i.position.scrollbarWidth():0,height:s?i.position.scrollbarWidth():0}},getWithinInfo:function(s){var t=i(s||n),e=i.isWindow(t[0]),a=!!t[0]&&9===t[0].nodeType;return{element:t,isWindow:e,isDocument:a,offset:t.offset()||{left:0,top:0},scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop(),width:e?t.width():t.outerWidth(),height:e?t.height():t.outerHeight()}}},s.position=function(n){if(!n||!n.of)return m.apply(this,arguments);n=i.extend({},n);var v,s,r,h,l,y,x=i(n.of),_=i.position.getWithinInfo(n.within),S=i.position.getScrollInfo(_),b=(n.collision||"fit").split(" "),w={};return y=g(x),x[0].preventDefault&&(n.at="left top"),s=y.width,r=y.height,h=y.offset,l=i.extend({},h),i.each(["my","at"],function(){var e,i,t=(n[this]||"").split(" ");1===t.length&&(t=u.test(t[0])?t.concat(["center"]):d.test(t[0])?["center"].concat(t):["center","center"]),t[0]=u.test(t[0])?t[0]:"center",t[1]=d.test(t[1])?t[1]:"center",e=f.exec(t[0]),i=f.exec(t[1]),w[this]=[e?e[0]:0,i?i[0]:0],n[this]=[p.exec(t[0])[0],p.exec(t[1])[0]]}),1===b.length&&(b[1]=b[0]),"right"===n.at[0]?l.left+=s:"center"===n.at[0]&&(l.left+=s/2),"bottom"===n.at[1]?l.top+=r:"center"===n.at[1]&&(l.top+=r/2),v=c(w.at,s,r),l.left+=v[0],l.top+=v[1],this.each(function(){var M,m,d=i(this),f=d.outerWidth(),p=d.outerHeight(),C=a(this,"marginLeft"),y=a(this,"marginTop"),$=f+C+a(this,"marginRight")+S.width,T=p+y+a(this,"marginBottom")+S.height,u=i.extend({},l),g=c(w.my,d.outerWidth(),d.outerHeight());"right"===n.my[0]?u.left-=f:"center"===n.my[0]&&(u.left-=f/2),"bottom"===n.my[1]?u.top-=p:"center"===n.my[1]&&(u.top-=p/2),u.left+=g[0],u.top+=g[1],i.support.offsetFractions||(u.left=o(u.left),u.top=o(u.top)),M={marginLeft:C,marginTop:y},i.each(["left","top"],function(t,e){i.ui.position[b[t]]&&i.ui.position[b[t]][e](u,{targetWidth:s,targetHeight:r,elemWidth:f,elemHeight:p,collisionPosition:M,collisionWidth:$,collisionHeight:T,offset:[v[0]+g[0],v[1]+g[1]],my:n.my,at:n.at,within:_,elem:d})}),n.using&&(m=function(g){var i=h.left-u.left,l=i+s-f,a=h.top-u.top,c=a+r-p,o={target:{element:x,left:h.left,top:h.top,width:s,height:r},element:{element:d,left:u.left,top:u.top,width:f,height:p},horizontal:0>l?"left":i>0?"right":"center",vertical:0>c?"top":a>0?"bottom":"middle"};f>s&&t(i+l)<s&&(o.horizontal="center"),p>r&&t(a+c)<r&&(o.vertical="middle"),o.important=e(t(i),t(l))>e(t(a),t(c))?"horizontal":"vertical",n.using.call(this,g,o)}),d.offset(i.extend(u,{using:m}))})},i.ui.position={fit:{left:function(t,n){var c,r=n.within,s=r.isWindow?r.scrollLeft:r.offset.left,o=r.width,l=t.left-n.collisionPosition.marginLeft,i=s-l,a=l+n.collisionWidth-o-s;n.collisionWidth>o?i>0&&0>=a?(c=t.left+i+n.collisionWidth-o-s,t.left+=i-c):t.left=a>0&&0>=i?s:i>a?s+o-n.collisionWidth:s:i>0?t.left+=i:a>0?t.left-=a:t.left=e(t.left-l,t.left)},top:function(t,i){var c,o=i.within,s=o.isWindow?o.scrollTop:o.offset.top,r=i.within.height,l=t.top-i.collisionPosition.marginTop,n=s-l,a=l+i.collisionHeight-r-s;i.collisionHeight>r?n>0&&0>=a?(c=t.top+n+i.collisionHeight-r-s,t.top+=n-c):t.top=a>0&&0>=n?s:n>a?s+r-i.collisionHeight:s:n>0?t.top+=n:a>0?t.top-=a:t.top=e(t.top-l,t.top)}}}}();return i.makeObject=function(n,s){var t,i={},e=[].slice.call(arguments);for(t=0;e.length>t;t++)i[e[t++]]=e[t];return i},i.isString=function(t){return"string"==typeof t},i.isNumber=function(t){return"number"==typeof t},i.isBoolean=function(t){return"boolean"==typeof t},s.play=function(){return this.each(function(){try{this.play()}catch(t){}})},s.pause=function(){return this.each(function(){try{this.pause()}catch(t){}})},s.audio=function(){return i(this).each(function(){var t=i(this),n=t[0];t.data(k)||(n.load?n.load():safariComplain(),t.data(k,!0).on(K,function(){i(D+b+me).not(this).pause(),i(ts).each(function(){try{i(this.contentDocument).find(D+b+me).pause()}catch(t){}}),i(this).closest(e+k).removeClass(vt).addClass(K)}).on(vt,function(){i(this).closest(e+k).removeClass(K).addClass(vt)}).on(Yn+e+k,function(){var t=i(this);t.closest(e+k).removeClass(K+h+vt),this.currentTime=0,this.pause(),t.siblings(ni).find("path").attr("d","M0 0")}).on(Wn+e+k,function(){var s=i(this),a=this.currentTime,l=this.duration,t=a/l,n=Math.range(0,360*t,359),r=n*Math.PI/180,c=153*Math.sin(r),h=-153*Math.cos(r),u=n>180?1:0,o=s.closest(e+le).children(e+Ye);t=100*t+Qt,o.children(g).css(q,t).text(A(a)),o.children(be).css(F,t),s.siblings(ni).find("path").attr("d","M 0 0"+(n>0?" v -153 A 153 153 1 "+u+" 1 "+c+" "+h+" z":""))}))}),this},s.loading=i.loading=function(r,o){var a=!0,t="ui-loading",s=i(this&&this!==i?this:"body"),e=s.data(t+"-element");return r===l?a=e===l:i.isBoolean(r)&&(a=r),a&&!e?s.data(t+"-element",e=w("div",t)).data(t+"-timeout",n.setTimeout(function(){e.appendTo(s).modal(!0)},o||100)):!a&&e&&(n.clearTimeout(s.data(t+"-timeout")),e.modal(!1).remove(),s.removeData([t+"-element",t+"-timeout"])),this},i.expr[":"].abc=function(e,s,n){if(!n[3])return i.hasData(e);var t=n[3].split("=");return 1===t.length?i(e).data(t[0])!==l:i(e).data(t[0])==t[1]},i.expr[":"].css=function(s,a,n){var t,e=i(s);return n[3]?(t=n[3].split("="),1===t.length?e.css(t[0])!==e.parent().css(t[0]):e.css(t[0])==t[1]):e.attr("style")},i.expr[":"].focusable=function(t){var e=t.nodeName.toLowerCase(),n=i.attr(t,"tabindex");return(/input|select|textarea|button|object/.test(e)||i.attr(t,Pt)?!t.disabled:"a"===e||"area"===e?t.href||!isNaN(n):!isNaN(n))&&i(t)["area"===e?"parents":"closest"](":visible").length},r(S,"bind",function(e,t){t=[].slice.call(arguments),e=t.shift();var i=this,n=function(){var n=e;return i.apply(n,t.concat([].slice.call(arguments,t.length)).slice(0))};return n.bind=function(){return S.bind.apply(i,[].slice.call(arguments))},n}),r(y,"regex",function(i){var e,n,t=this.match(i);if(t){for(i.global?/(^|[^\\]|[^\\](\\\\)*)\([^?]/.test(i.source)&&(n=RegExp(i.source,(i.ignoreCase?"i":"")+(i.multiline?"m":""))):t.shift(),e=t.length;e--;)t[e]&&(n?t[e]=t[e].regex(n):t[e].search(/^[\-+]?\d*\.?\d+(?:e[\-+]?\d+)?$/i)>=0&&(t[e]=parseFloat(t[e])));if(!n&&1===t.length)return t[0]}return t}),r(y,"regexIndexOf",function(i,e){var t=this.substring(e||0).search(i);return t>=0?t+(e||0):t}),r(y,"unicode",function(){return this.replace(/[\u0100-\uffff]/g,function(t){return"\\u"+("0000"+t.charCodeAt().toString(16)).slice(-4)})}),r(c,"shuffle",function(){for(var i,e,t=this.length;--t>0;)e=Math.floor(Math.random()*(t+1)),i=this[e],this[e]=this[t],this[t]=i;return this}),r(c,"wrap",function(i,t,e){return i=i===l?"":i,t=t===l?"":t,e=e===l?"":e,t+this.join(e+i+t)+e}),r(c,"grow",function(t,s){var i=0,n=Math.abs(t),e=[].slice.call(arguments,1);if(n>this.length)for(e=e.length?e:[0];n>this.length;)i>=e.length&&(i=0),this.push(e[i++]);else t>0&&this.length>t&&this.splice(t,this.length-t);return this}),r(c,"dup",function(t){return t?JSON.parse(JSON.stringify(this)):this.slice(0)}),r(c,"unique",function(){for(var t=this.length;t-->0;)t>this.indexOf(this[t])&&this.splice(t,1);return this}),r(c,"indexOfCase",function(i,e){var t,n=this.length>>>0;for(e=e||0,i=i.toUpperCase(),t=Math.max(e>=0?e:n-Math.abs(e),0);n>t;t++)if(t in this&&this[t].toUpperCase()===i)return t;return-1}),r(c,"pushOnce",function(i){for(var t=0,e=arguments;e.length>t;t++)-1===this.indexOf(e[t])&&this.push(e[t])}),r(c,"remove",function(e){var t=this.indexOf(e);t>=0&&this.splice(t,1)}),r(c,"removeCase",function(e){var t=this.indexOfCase(e);t>=0&&this.splice(t,1)}),r(c,"clean",function(){for(var t=0,e=[];this.length>t;t++)(this[t]||0===this[t]||this[t]===!1)&&e.push(this[t]);return e}),r(c,"natcasesort",function(){return this.sort(function(o,r){o=(o+"").toLowerCase(),r=(r+"").toLowerCase();var t,e,n,s,i,c,a,h,u=o.length,d=r.length,l=function(e){var t=e.charCodeAt(0);return t>=48&&57>=t};for(n=s=0;u>n&&d>s;n++,s++){if(t=o.charAt(n),e=r.charAt(s),l(t)&&l(e)){for(i=c=0;l(t);t=o.charAt(++n))c++,i=10*i+parseInt(t,10);for(a=h=0;l(e);e=r.charAt(++s))h++,a=10*a+parseInt(e,10);t=i===a?c:i,e=i===a?h:a,n--,s--}if(e>t)return-1;if(t>e)return 1}return u===d?0:u>d?1:-1})}),r(m,"count",function(){var t,e=0;for(t in this)this.hasOwnProperty(t)&&e++;return e}),r(m,"setTree",function(t,s){var e=function(t,a,r,s){var n=a[s];if(a.length-1>s){if(i.isString(t[n])&&i.isNumber(a[s+1])?t[n]=[t[n]]:i.isPlainObject(t[n])||i.isArray(t[n])||(t[n]=i.isNumber(a[s+1])?[]:{}),!e(t[n],a,r,s+1)&&s>=1&&i.isEmptyObject(t[n]))return delete t[n],!1}else if(r!==t[n]){if(r===l){if(delete t[n],i.isArray(t))for(;t.length&&t[t.length-1]===l||null===t[t.length-1];)t.pop();return!1}t[n]=r}return!0};if(i.isPlainObject(t))for(var n in t)t.hasOwnProperty(n)&&e(this,i.explode(n),t[n],0);else e(this,i.explode(t),s,0);return this}),r(m,"getTree",function(n,s){for(var t=this,e=i.explode(n);e.length&&t!==l;)t=t[e.shift()];return t===l||null===t?s:t}),r(m,"hasTree",function(n){for(var t=this,e=i.explode(n);e.length&&t!==l;)t=t[e.shift()];return!(t===l||null===t)}),r(m,"indexOfX",function(e){var t;for(t in this)if(this.hasOwnProperty(t)&&this[t]===e)return t;return null}),r(m,"dup",function(){return JSON.parse(JSON.stringify(this))}),r(m,"clear",function(){for(var t in this)this.hasOwnProperty(t)&&delete this[t];return this}),r(m,"bestMatch",function(n){var i,t,e=-1;for(i in this)t=parseInt(i),this.hasOwnProperty(i)&&t>e&&n>=t&&(e=t);return e>-1?this[e]:l}),r(m,"equals",function(e){var t;for(t in this)if(this.hasOwnProperty(t)){if(!e.hasOwnProperty(t)||typeof this[t]!=typeof e[t]||!this[t]!=!e[t])return!1;switch(typeof this[t]){case"object":if(null!==this[t]&&null!==e[t]&&(""+this[t].constructor!=""+e[t].constructor||!this[t].equals(e[t])))return!1;break;case"function":if(""+this[t]!=""+e[t])return!1;break;default:if(this[t]!==e[t])return!1}}for(t in e)if(!this.hasOwnProperty(t))return!1;return!0}),r(y,"ucfirst",function(){return this.charAt(0).toUpperCase()+this.slice(1)}),r(y,"text",function(){return this.replace(/<\/?(img|li|ul|ol|span|div)[^>]*>/gi,"")}),r(y,"reverse",function(){return this.split("").reverse().join("")}),r(y,"fromBBCode",function(){var n,s,e=this,r={"":/^\s+|\s+$/g," &nbsp;":/\s{2}/gi,"&bull;&nbsp;":/\[\*\]/gi,'<span class="abc-icon">$1</span>':/\[icon\s?([\s\S]*?)\]/gi,"<br />":/\s*\[br\]/gi,"<b>$1</b>":/\[b\]([\s\S]*?)\[\/b\]/gi,"<i>$1</i>":/\[i\]([\s\S]*?)\[\/i\]/gi,"<u>$1</u>":/\[u\]([\s\S]*?)\[\/u\]/gi,"<s>$1</s>":/\[s\]([\s\S]*?)\[\/s\]/gi,'<span class="abc-custom-$1">$2</span>':/\[style\s?([^\]]+)\]([\s\S]*?)\[\/style\s?\1\]/gi,'<span class="$1">$2</span>':/\[span\s([^\]]+)\]([\s\S]*?)\[\/span\]/gi,"<span>$1</span>":/\[span\]([\s\S]*?)\[\/span\]/gi,'<div class="$1">$2</div>':/\[div\s([^\]]+)\]([\s\S]*?)\[\/div\]/gi,"<div>$1</div>":/\[div\]([\s\S]*?)\[\/div\]/gi,'<dfn data-title="$1">$2</dfn>':/\[define ([^\]]*)\]([\s\S]*?)\[\/define\]/gi,'<div style="text-align:left;">$1</div>':/\[left\]([\s\S]*?)\[\/left\]/gi,'<div style="text-align:center;">$1</div>':/\[center\]([\s\S]*?)\[\/center\]/gi,'<div style="text-align:right;">$1</div>':/\[right\]([\s\S]*?)\[\/right\]/gi,"<sub>$1</sub>":/\[sub\]([\s\S]*?)\[\/sub\]/gi,"<sup>$1</sup>":/\[sup\]([\s\S]*?)\[\/sup\]/gi,'<a href="$1">$2</a>':/\[url=([^\]]+)\]([\s\S]*?)\[\/url\]/gi,'<a href="$1">$1</a>':/\[url\]([\s\S]*?)\[\/url\]/gi,'<span style="color:$1;">$2</span>':/\[color[= ](.*?)\]([\s\S]*?)\[\/color\]/gi,'<span style="background-color:$1;">$2</span>':/\[bg[= ](.*?)\]([\s\S]*?)\[\/bg\]/gi,'<span style="font-size:200%;">$1</span>':/\[xx-large\]([\s\S]*?)\[\/xx-large\]/gi,'<span style="font-size:150%;">$1</span>':/\[x-large\]([\s\S]*?)\[\/x-large\]/gi,'<span style="font-size:120%;">$1</span>':/\[large\]([\s\S]*?)\[\/large\]/gi,'<span style="font-size:88%;">$1</span>':/\[small\]([\s\S]*?)\[\/small\]/gi,'<span style="font-size:75%;">$1</span>':/\[x-small\]([\s\S]*?)\[\/x-small\]/gi,'<span style="font-size:60%;">$1</span>':/\[xx-small\]([\s\S]*?)\[\/xx-small\]/gi,'<span class="codeStyle">$1</span>':/\[code\]([\s\S]*?)\[\/code\]/gi,'<span class="quoteStyle">$1</span>':/\[quote.*?\]([\s\S]*?)\[\/quote\]/gi};for(n in r)if(r.hasOwnProperty(n))for(s=-1;s!==e;e=e.replace(r[n],n))s=e;return e=e.replace(/\[table\]([\s\S]*?)\[\/table\]/gi,function(e,t){return"<table><tr>"+t.replace(/(^|\[tr\])(?!\[th|\[td)/gi,"$1[td]").replace(/\[(th|td)\s+(\d)+\]([\s\S]*?)(?=\[th|\[td|\[tr|$)/gi,'<$1 colspan="$2">$3</$1>').replace(/\[(th|td)\]([\s\S]*?)(?=\[th|\[td|\[tr|$)/gi,"<$1>$2</$1>").replace(/\[tr\]/gi,"</tr><tr>")+"</tr></table>"}).replace(/\[img\](.*?)\[\/img\]/gi,function(e,t){return'<img src="'+i.currentHandler[p](t)+'" />'}).replace(/\[img\s+(\S*?)\]/gi,function(e,t){return'<img src="'+i.currentHandler[p](/[^0-9]/.test(t)?t:"image_"+t)+'" />'}).replace(/\[audio\s+(wide\s+)?(\S*?)\]/gi,function(r,e,t){var n=/[^0-9]/.test(t)?t:"sound_"+t,s=i.currentHandler[p](n+".mp3")||i.currentHandler[p]("default.mp3"),a=i.currentHandler[p](n+".ogg")||i.currentHandler[p]("default.ogg");return'<span class="abc-audio-wrapper"><span class="abc-audio-button"><span class="abc-icon abc-audio">'+(e?"":'<svg viewBox="0 0 300 300"><path class="progress" transform="translate(150, 150)" d="M0 0"/></svg>')+'<audio preload="auto"><source src="'+s+'" type="audio/mpeg"/><source src="'+a+'" type="audio/ogg"/></audio></span></span>'+(e?'<span class="abc-audio-control"><hr/><span></span></span>':"")+"</span>"}).replace(/\[activitycount(!?)\]/gi,function(s,e){var n=i.currentHandler[$]([a,"pageNumber"],i.currentHandler.navigationTitle)||(i.currentHandler[t]([a,"letters"])?String.fromCharCode(97+i.currentHandler.countLeft(!1,!0)):i.currentHandler.countLeft(!0)+1+(e?"/":'</span>/<span class="abc-activity-total">')+i.currentHandler.countTotal(!0));return(e?"":'<span class="abc-activity-index">')+n+(e?"":"</span>")}).replace(/\[activity(!?)\]/gi,function(s,e){var n=i.currentHandler[$]([a,"pageNumber"],i.currentHandler.navigationTitle)||(i.currentHandler[t]([a,"letters"])?String.fromCharCode(97+i.currentHandler.countLeft(!1,!0)):i.currentHandler.countLeft(!0)+1);return(e?"":'<span class="abc-activity-index">')+n+(e?"":"</span>")}).replace(/\[activities(!?)\]/gi,function(e,t){return(t?"":'<span class="abc-activity-total">')+i.currentHandler.countTotal(!0)+(t?"":"</span>")}).replace(/\[(li|ol)\]([\s\S]*?)(<br \/>|<\/td>|$)/gi,function(s,t,n,e){var i="ol"===t?"ol":"ul";return"<"+i+' class="abc-list"><li>'+n.replace(RegExp("\\["+t+"\\]","gi"),"</li><li>")+("<br />"===e?"":e)+"</li></"+i+">"}).replace(/<\/ul><ul class="abc-list">/gi,"").replace(/<\/ol><ol class="abc-list">/gi,"")}),r(y,"toBBCode",function(){var t,e=this.trim(),i={"":/<\/?p>/gi,"[url=$1]$2[/url]":/<a [^>]*?href=\"([^\"]*?)\".*?>(.*?)<\/a>/gi,"[color=$1]$2[/color]":/<span [^>]*?style=\"color:\s?([^\";]+).*?\".*?>(.*?)<\/span>/gi,"[bg=$1]$2[/bg]":/<span [^>]*?style=\"background-color:\s?([^\";]+).*?\".*?>(.*?)<\/span>/gi,"[img]$1[/img]":/<img [^>]*?src=\"([^\"]*?)\".*?\/>/gi,"[img $1]":/<img [^>]*?src=\".*\/([^\/\"]*?)\.(gif|png|svg)\".*?\/>/gi,
"[code]$1[/code]":/<span [^>]*?class=\"codeStyle\".*?>(.*?)<\/span>/gi,"[quote]$1[/quote]":/<blockquote.*?>(.*?)<\/blockquote>/gi,"[xx-small]$1[/xx-small]":/<span [^>]*?style=\"font-size:\s?60%;?\".*?>(.*?)<\/span>/gi,"[x-small]$1[/x-small]":/<span [^>]*?style=\"font-size:\s?75%;?\".*?>(.*?)<\/span>/gi,"[small]$1[/small]":/<span [^>]*?style=\"font-size:\s?88%;?\".*?>(.*?)<\/span>/gi,$1:/<span [^>]*?style=\"font-size:\s?100%;?\".*?>(.*?)<\/span>/gi,"[large]$1[/large]":/<span [^>]*?style=\"font-size:\s?120%;?\".*?>(.*?)<\/span>/gi,"[x-large]$1[/x-large]":/<span [^>]*?style=\"font-size:\s?150%;?\".*?>(.*?)<\/span>/gi,"[xx-large]$1[/xx-large]":/<span [^>]*?style=\"font-size:\s?200%;?\".*?>(.*?)<\/span>/gi,"[$1]$2[/$1]":/<(sub|sup)>(.*?)<\/\1>/gi,"[b]$2[/b]":/<(strong|b)>(.*?)<\/\1>/gi,"[i]$2[/i]":/<(em|i)>(.*?)<\/\1>/gi,"[u]$2[/u]":/<(u|span [^>]*?style=\"text-decoration:\s?underline;?\").*?>(.*?)<\/\1>/gi,"[activitycount]":/<span class="abc-activity-index">\d+<\/span>\/<span class="abc-activity-total">\d+<\/span>/gi,"[activity]":/<span class="abc-activity-index">\d+<\/span>/gi,"[activities]":/<span class="abc-activity-total">\d+<\/span>/gi,"[br]":/(\s*<br ?\/?>|\s*\n)/gi,'"':/&quot;/gi,"<":/&lt;/gi,">":/&gt;/gi,"&":/&amp;/gi," ":/&nbsp;|\u00a0/gi};for(t in i)i.hasOwnProperty(t)&&(e=e.replace(i[t],t));return e=e.replace(/<ul[^>]*>(.*?)<\/ul>/gi,function(e,t){return t.replace(/<li[^>]*>(.*?)<\/li>/gi,"[li]$1")+"[br]"}).replace(/<ol[^>]*>(.*?)<\/ol>/gi,function(e,t){return t.replace(/<li[^>]*>(.*?)<\/li>/gi,"[ol]$1")+"[br]"}).replace(/(\[br\]+)$/gi,"").replace(/<([a-z]+)>( |)<\/\1>/gi,"$2").replace(/<\/([a-z]+)>( |)<\1>/gi,"$2")}),r(Math,"range",function(t,e,i){return Math.max(t,Math.min(e,i))}),r(M,"range",function(t,e){return this>=Math.min(t,e)&&this<=Math.max(t,e)}),r(M,"addCommas",function(e){var t=i.isNumber(e)?this.toFixed(e):this,n=/^(.*\s)?(\d+)(\d{3}\b)/;for(t=""+t;n.test(t);)t=t.replace(n,"$1$2,$3");return t}),r(JSON,"shallow",function(e,i,n,s){var t=function(e,s){var i,n;if(e&&"object"==typeof e)if(Array.isArray(e))if(s>0)for(n=[],i=0;e.length>i;i++)n[i]=t(e[i],s-1);else n="[object Array]";else if(s>0){n={};for(i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i],s-1))}else n="[object Object]";else n=e;return n};return JSON.stringify(t(e,i||1),n,s)}),r(Date,"now",function(){return(new Date).getTime()}),r(Date,"format",function(t){return(new Date).format(t)}),r(O,"format",function(l){if(isNaN(this))return"Invalid Date";var t=this,i=t.getDate(),n=t.getDay(),r=t.getMonth(),o=t.getFullYear(),s=t.getHours(),g=t.getMinutes(),p=t.getSeconds(),v=t.getMilliseconds(),d=["January","February","March","April","May","June","July","August","September","October","November","December"],u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e=function(t){return 9>=t?"0"+t:""+t},h=!1,f=[],a=function(t,e){return t+" "+e+(1===t?"":"s")},m=function(f){if(h)return h=!1,f;switch(f){case"\\":return h=!0,"";case"d":return e(i);case"D":return u[n].substr(0,3);case"j":return i;case"l":return u[n];case"N":return n+1;case"S":return i%10===1&&11!==i?"st":i%10===2&&12!==i?"nd":i%10===3&&13!==i?"rd":"th";case"w":return n;case"R":var l=(new Date-t)/1e3;return 0>l?"In the Future":20>l?"Just Now":60>l?"Less than a Minute Ago":120>l?"About a Minute Ago":3600>l?a(Math.floor(l/60),"Minute")+" Ago":7200>l?"About an Hour Ago":43200>l?a(Math.floor(l/3600),"Hour")+" Ago":172800>l&&n===(new Date).getDay()?"Today":259200>l&&(6===n?0:n+1)===(new Date).getDay()?"Yesterday":604800>l?a(Math.floor(l/86400),"Day")+" Ago":2678400>l?a(Math.floor(l/604800),"Week")+" Ago":31536e3>l?a(Math.floor(l/2678400),"Month")+" Ago":a(Math.floor(l/31536e3),"Year")+" Ago";case"F":return d[r];case"m":return e(r+1);case"M":return d[r].substr(0,3);case"n":return r+1;case"L":return o%4===0&&o%100!==0||o%400===0?"1":"0";case"Y":return o;case"y":return(""+o).substr(2);case"a":return 12>s?"am":"pm";case"A":return 12>s?"AM":"PM";case"g":return s%12||12;case"G":return s;case"h":return e(s%12||12);case"H":return e(s);case"i":return e(g);case"s":return e(p);case"u":return v.substr(0,3);case"O":var c=t.getTimezoneOffset();return(0>c?"+":"-")+e(Math.abs(c/60))+"00";case"P":var c=t.getTimezoneOffset();return(0>c?"+":"-")+e(Math.abs(c/60))+":"+e(Math.abs(c%60));case"T":var m;return t.setMonth(0),m=t.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1"),t.setMonth(r),m;case"Z":return 60*-t.getTimezoneOffset();case"c":return t.format("Y-m-d\\TH:i:sP");case"r":return""+t;case"U":return t.getTime()/1e3;default:return f}};l=l||"c";for(var c=0;l.length>c;c++)f.push(m(l[c]));return f.join("")}),r(n,"atob",function(t){var o,h,c,l,r,s,a,n="",e=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");t.length>e;)l=i.indexOf(t.charAt(e++)),r=i.indexOf(t.charAt(e++)),s=i.indexOf(t.charAt(e++)),a=i.indexOf(t.charAt(e++)),o=l<<2|r>>4,h=(15&r)<<4|s>>2,c=(3&s)<<6|a,n+=String.fromCharCode(o),64!==s&&(n+=String.fromCharCode(h)),64!==a&&(n+=String.fromCharCode(c));return n}),r(n,"btoa",function(t){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var i,e,r=base64.PADCHAR,n=base64.ALPHA,a=base64.getbyte,s=[];t=""+t;var o=t.length-t.length%3;if(0===t.length)return t;for(i=0;o>i;i+=3)e=a(t,i)<<16|a(t,i+1)<<8|a(t,i+2),s.push(n.charAt(e>>18)),s.push(n.charAt(e>>12&63)),s.push(n.charAt(e>>6&63)),s.push(n.charAt(63&e));switch(t.length-o){case 1:e=a(t,i)<<16,s.push(n.charAt(e>>18)+n.charAt(e>>12&63)+r+r);break;case 2:e=a(t,i)<<16|a(t,i+1)<<8,s.push(n.charAt(e>>18)+n.charAt(e>>12&63)+n.charAt(e>>6&63)+r)}return s.join("")}),s.convertCSS=function(s,o){if(s===l||""===s)return 0;var t=parseFloat(s);switch(s.replace(/[^a-z%]/g,"").substr(0,4)){case kt:t=0;break;case En:var e,a,r=s.replace(/^calc\(|\)$/g,"").split(" ");for(t=this.convertCSS(r.shift(),o);r.length;)e?(a=this.convertCSS(r.shift(),o),"+"===e?t+=a:"-"===e?t-=a:"*"===e?t*=a:"/"===e&&(t/=a),e=""):e=r.shift();break;case it:t*=parseFloat(this.css(ye));break;case Qt:t*=this.parent()[o?F:X]()/100;break;case Bn:t*=parseFloat(i(qt).css(ye));break;case Nn:t*=n.innerHeight/100;break;case An:t*=n.innerWidth/100;break;case Ln:t*=Math.min(n.innerWidth,n.innerHeight)/100;break;case In:t*=Math.max(n.innerWidth,n.innerHeight)/100;break;case Kt:case"":break;default:return s}return t},w}),define("_const",!0);var ds="Infuze Creator",hs="asset",Qe=">",b=",",c=":",H="-",Y="#",cs="http",e=".",rs=e+"ttf",as=e+"woff",N="=",ze="handler",Te="&nbsp;",Je="/",h=" ",ss="after",ns="before",Ct="type",Ce="text",Me="a",D="audio",wt="body",is="br",zt="button",u="div",_e="h1",we="h2",xe="h3",es="header",be="hr",ts="iframe",rt="img",$t="input",Ue="link",At="script",Ze="select",g="span",ni="svg",Qn="table",ci="textarea",ui="td",Zn="time",Gn="tr",me="video",ge="update",z="click",Kn="contextmenu",Xn="dragstart",Yn="ended",Jn="error",de="fullscreenchange",jn="keydown",ot="load",li=ot+"ed",ue="mouse",ht=ue+"down",Lt=ue+"move",he=ue+"up",qn="orientationchange",ce="resize",We="scroll",Wn="time"+ge,re="touch",ae=re+"end",Tt=re+"move",ne=re+"start",En="calc",it="em",kt="none",Qt="%",Kt="px",Bn="r"+it,Nn="vh",In="vmax",Ln="vmin",An="vw",On="copy",R="feedback",_t="footer",jt="fullscreen",qt="html",$n="items",q="left",ti="limit_attempts",m="module",Ot=m+"s",Tn="_path",dt="right",a="settings",i="theme",Sn="You scored ",gt="attempts",_n="colour",bi="common",oe="count",wn="data",Re="dialog",bn="false",Et="first",pn="get",fn="goto",dn="help",Xe="index",I="marked",Ve="nav",Dt=Ve+"igate",Ge="pass",un="parent",Mt="persist",St="points",ln="print",Yt="refresh",Xt="reset",oi="response",Ut="reveal",L="score",on="set"+Ge,Gt="showPath",fi="startup",Zt="submit",sn="total",te=Zn+"r",en="true",Le="viewed",ke="js",Ie="min"+e+ke,Pe="java",gs="fullscreenElement",tn="exitFullscreen",Qi="requestFullscreen",Ui="absolute",Ne="top",Ft="auto",Ee="background",pt=Ee+"-image",Yi="block",qe="bold",ji="border",qi="box-shadow",Wi="center",B="color",U=Ee+H+B,ft=ji+H+B,Di="complete",Bi="content",Pt=Bi+"editable",Ni="disable",d=Ni+"d",Fi="fadeIn",ii="fadeOut",C="font",et=C+"-family",ye=C+"-size",Ri=C+"-style",zi=C+"-weight",v="hidden",X="height",Pi="hover",Se="id",Ii="_"+Se,ki="inline",Li=ki+"-"+Yi,M="invisible",mi="italic",Ai="margin",Ci=Ai+H+Ne,yi="normal",Mi="opacity",wi="overflow",Si=wi+"-x",yn=wi+"-y",K="play",vt="pause",Ti="position",$i="src",Oi="style",vi="visibility",F="width",W="z-index",P="max",hi=P+H,j="min",ri=hi+X,ei=hi+F,Hi="star",f="abc",r=f+H,Ei=r+"activities",k=r+D,Ye=k+"-control",le=k+"-wrapper",Bt=r+"background",Ji=Bt+H,Z=r+"box",Be=Z+H,He=Be+1,Vi=r+zt,Ki=r+zt+"s",Gi=r+"choice",Zi=r+"close",se=r+_n,lt=se+H,ee=lt+1,nn=r+"complete",It=r+"content",an=It+"-box",rn=r+On,nt=r+"cross",Ht=r+"dfn-popup",cn=r+Re,hn=r+d,Q=r+R,yt=r+_t,je=r+jt,xt=r+es,gn=r+"icon",mn=r+"menu",vn=r+m,Fe=r+"nav",_i=r+"parent",xn=r+"select",x=xn+"ed",mt=r+"show",di=r+"slideout",J=r+"tick",S=r+"visible",ut="ui-",Wt=ut+"front",T=ut+"line",Ae=ut+"loading",Vt=ut+"modal",kn=ut+"state-",gi=kn+Pi,Pn="dropdown",zn="editable",Rn="fill_the_gaps",Fn="group",Hn="link",Rt="-1",p="-2",O="-3",Dn="-4",G="-5",ct="-6",si="-7",fe="-a",at="-b",E="-k",t="-l",Vn="-m",pe="-n",V="-o",pi="-p",$="-q",ve="-r",ai="-s",st="-t",xi="-u",bt="-v",y="-w",$e="-x",A="-y",ls="-z",w="-A",_="-B",us="-C",tt="-D",Oe="-E",Jt="-F",s="-G";define("activity",[Nt,Ke,Xi],function(T,Z){function ue(){if(!ue.done){ue.done=!0;var t=navigator.userAgent.toLowerCase();-1!==t.indexOf("safari/")&&-1!==t.indexOf("windows")&&alert("Please install QuickTime to enable Audio or Video in Safari on Windows")}}function o(){}function ni(t){if(Ke&&(n.navigator.standalone&&t.css(Ci,1+it),t.is(wt)))try{var e=function(){n.scrollTo(0,1)},i=function(){T(qt+b+wt).css(ri,n.innerHeight).css(ei,n.innerWidth)};T(n).on(We,e).on(qn,i),i(),setTimeout(e,1e3)}catch(t){}}function Qe(){try{o.parent.find(D+b+me).pause()}catch(t){}}function re(t){T(e+Ht).not(t).velocity(ii,function(){T(this).remove()})}function Re(t){var e=t.touches?t.changedTouches[0]:t,i=o.mouse;i.x=e.pageX,i.y=e.pageY}function ge(){var t,e;for(t=0;o.count>t;t++)if(e=o[t],!e._visible){if(!(Vt+250>Date.now()))return T.rAF(function(){Vt=Date.now(),ge()}),l;o[A](!1,e)}T(n).resize()}function ie(e,i,n){return e[y]()?!1:n?!!e[t]([a,"letters"]):i&&(e.navigationTitle||e[t]([a,"letters"])||e[t]([a,"pageNumber"]))?!1:!0}function De(){try{for(var t=n;t.parent!==t&&!t.closeABC;)t=t.parent;t.closeABC&&(this.btnClose=Z(g,Zi).on(z,function(){for(var t=n;t.parent!==t&&!t.closeABC;)t=t.parent;t.closeABC&&t.closeABC()}))}catch(t){}}function Ee(){var i=!0,s=function(t){var e=t[St];return-1===e&&(e=t[P]),e?(t[I]?t[Ft]?t[L]?e*Math.min(1,(t[L]+t[j])/(t[P]-t[j])):0:"?":"-")+" / "+e:"-"};o.API.addModule(Gt,{always:!0,nice:5,startup:function(){T.stylesheet({"#abc>.abc-activities>.showPath>.abc-slideout":"position:absolute;top:0;left:0;right:0;margin:0;text-align:center;z-index:1000;padding:0;pointer-events:all;user-select:all;font-family:sans-serif;font-size:16px;","#abc>.abc-activities>.showPath>.abc-slideout>div":"display:none;background:lightgrey;border:2px solid red;border-bottom-left-radius:0.25em;border-bottom-right-radius:0.25em;vertical-align:bottom;border-top:none;","#abc>.abc-activities>.showPath>.abc-slideout>div>table":"border-collapse:separate;border-spacing:1px;margin:0;padding:0.5em;width:auto;","#abc>.abc-activities>.showPath>.abc-slideout>div>table td":"padding:0.1em;width:auto;vertical-align:bottom;","#abc>.abc-activities>.showPath>.abc-slideout>div>table td:first-child":"text-align:right;","#abc>.abc-activities>.showPath>.abc-slideout>div>table td+td":"background:white;border-radius:3px;","#abc>.abc-activities>.showPath>.abc-slideout>div>table td+td>input":"border:none;padding:1px 3px;width:15em;cursor:text;","#abc>.abc-activities>.showPath>.abc-slideout>div[style*=inline]+span":"border-bottom-width:1em;","#abc>.abc-activities>.showPath>.abc-slideout>span":"display:block;width:5em;margin:0 auto;border-bottom:0.5em solid red;border-bottom-left-radius:0.5em;border-bottom-right-radius:0.5em;","#abc>.abc-activities>.showPath>.abc-slideout>span:hover":"border-bottom-width:1em;"})},load:function(w){var d=T(this.id);if(n.abc.showPath&&!d.hasClass(Gt)){var o,p,r=T.currentHandler,a=r[t].bind(r),y=function(){return this.select(),!1},l="D j M Y, g:i:sa",f=a(["_date"],""),h=a(["_editor"],""),m=a(["_edited"],""),v=a(["_creator"],""),b=a(["_created"],""),x=function(e,t){(T.isNumber(t)||(T.isString(t)||T.isArray(t))&&t.length)&&Z(Gn,Z(ui,"="+e+":"),Z(ui,Z($t,"type=text","readonly=","name="+e,"value="+t))).appendTo(p)},c={Version:oi,ID:a(["_id"]),File:a(["_path"]),Name:a(["_name"],"").fromBBCode(),Type:r.type+(r._type?" -> "+r._type:""),Modules:Object.keys(a(["modules"],{})||{}),Creator:v&&!h?v:null,Created:b&&!h?new Date(b).format(l):null,Editor:h,Edited:m?new Date(m).format(l):null,Changed:f?new Date(f).format(l):null,Score:s(w)};Z(u,di,Z(u,p=Z(Qn).on(ht,$t,y)),Z(g).on(z,function(){return i=!i,T(e+di).children(u).velocity("slide"+(i?"Up":"Down"),{display:i?kt:Li}),!1})).appendTo(d.addClass(Gt));for(o in c)c.hasOwnProperty(o)&&x(o,c[o])}},persist:function(t){T(this.id+">.abc-slideout input[name=Score]").val(s(t))}})}var oi=T.log(ds+h+"v0.14.8 (Monday 25th Jul 2016 14:37:12)"),ut=n.document,Wt=ut.location,Nt=[],Vt=Date.now();T.event.props.pushOnce("touches","changedTouches");var Ke=(n.abc=T.extend({},{showPath:!1,duration:400,lineCount:40,minSize:50,maxSize:200,footer:"fullscreen,help,print|?submit,?reset,?reveal|first,left,nav,right"},n.abc),n.navigator&&/mobile/i.test(n.navigator.userAgent)),$e=400,H=o.prototype;o.ActivityTypes={},o[si]=function(i){var e=function(){o.call(this)},t=e.prototype=new o;return o.ActivityTypes[i]=e,t.constructor=e,t.type=i,t.proto=o.prototype,t},o.handler=null,o[xi]=function(){var i=0,s=function(t){return t===Ft||t===We};o.parent[0].addEventListener(z,function(t){return t[f]?l:(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),!1)},!0),T(ut).on(jn,function(i){var t=i.keyCode,n=o.handler,s=T(ut.activeElement),a=s.is("body");if(9===t){var r=n.context.find(".abc-dialog,.abc-content").first().find(":focusable"),l=r.length,c=r.index(i.target),e=c+(i.shiftKey?-1:1);l&&(0>e?e=l-1:e>=l&&(e=0),c!==e&&r.eq(e).focus())}else if(13===t&&a)n.onSubmit();else if(33===t||37===t&&a)n.onLeft();else if(34===t||39===t&&a)n.onRight();else{if(32!==t||!s.is("button"))return;s.click()}i.preventDefault()}),o.parent.on(ne+h+ht,function(l){if(!l.isDefaultPrevented()&&o.handler&&!T(l.target).closest($t+b+ci+b+"["+Pt+"='true']")[0]&&2>l.which){o.momentum=i=0;var c,g,M=o.handler,A=M.context,w=l.target,S=w,r=null,h=!!l.touches,x=0,v={Left:h?l.changedTouches[0].pageX:l.pageX,Top:h?l.changedTouches[0].pageY:l.pageY},p={Left:v.Left,Top:v.Top},m=o.$activities[0],O=o.parent[0],u=[],$=function(){for(var t=Date.now();u.length&&t-100>u[0][0];)u.shift()},C=function(){T(ut).off(e+f)};l.preventDefault(),T(ut).on((h?Tt:Lt)+e+f,function(l){if(!h&&!l.which||l.isDefaultPrevented()){if(C(),r===m){var k=o.$activities.children(e+f+":visible");o[_](k.eq(Math.range(0,Math.round(Math.max(1,r.scrollLeft)/r.clientWidth),k.length-1)).data("index"))}}else{if(S=l.target,p.Left=h?l.changedTouches[0].pageX:l.pageX,p.Top=h?l.changedTouches[0].pageY:l.pageY,!r){var i,L,w=v.Top-p.Top,T=v.Left-p.Left,I=Math.abs(T)>9,P=Math.abs(w)>9;if(!I&&!P)return;for(i=l.target;!r&&i&&i!==ut.body&&(L=n.getComputedStyle(i),i===O&&(i=m),I&&(i===m&&!M[y]()&&M[t]([a,Dt],!0)||s(L[Si]))&&(0>T&&i.scrollLeft||T>0&&i.scrollWidth>=i.scrollLeft+i.clientWidth+T)&&(r=i,c="Left",g="Width"),P&&s(L[yn])&&(0>w&&i.scrollTop||w>0&&i.scrollHeight>i.scrollTop+i.clientHeight+w)&&(r=i,c="Top",g="Height"),i!==m);i=i.parentNode);r?(x=r["scroll"+c],r===m&&(o.$activities.velocity("stop"),A.css(W,1))):C()}if(r&&!o.$abcFooter.hasClass(d)){u.push([Date.now(),p[c]]),$();var b=p[c]-v[c];0>b?b=Math.min(r["scroll"+g]-r["client"+g],x-b):b>0&&(b=Math.max(0,x-b)),r["scroll"+c]=b,l.preventDefault()}}}).one(h?ae:he,function(t){if(C(),r){if($(),u.length>1){var h=u.shift(),d=u.pop(),y=(d[0]-h[0])/1e3;i=(d[1]-h[1])/y}var a=.4*i,l=r["scroll"+c],s=Math.min(1,r["client"+g]/Math.abs(a)/2);if(r===m){var p=o.$activities.children(e+f+":visible");(i>10||-10>i)&&(l-=a,o.momentum=s),o[_](p.eq(Math.range(0,Math.round(Math.max(1,l)/r["client"+g]),p.length-1)).data("index"))}else T(r).children().first().velocity("scroll",{axis:"Left"===c?"x":"y",offset:l-a/2,container:r,duration:400,easing:s?[.02,Math.range(.01,s,.97),.47,1]:"swing"})}else if(!t.isDefaultPrevented()){var v=S?T(w).commonFirst(S):w,b=v.is(Ze),n=ut.createEvent("MouseEvents");n.initMouseEvent(b?ht:z,!b,!0,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),n[f]=!0,v[0].dispatchEvent(n)}})}}).on(z,e+f+h+"dfn",function(t){var i,n=T(this);i=n.next(e+Ht),re(),i.length||(i=Z(u,Ht,"="+n.data("title"),Z(g)).insertAfter(n).velocity(Fi).position({my:"center top",at:"center bottom",of:t,collision:"fit",within:n.closest(e+f),using:function(n,a){for(var i=a.target.top-T(t.target).offset().top,s=n.top-i,e=parseFloat(T(t.target).css("line-height"));i>e;)i-=e,s+=e;T(this).css({top:s+e+11,left:n.left})}}),i.children(g).position({my:"center",at:"center",of:t,collision:"fit",using:function(t){T(this).css(q,t.left)}}))}).on(ht+h+ne,function(t){T(t.target).closest(e+Ht+",dfn").length||(re(),o.closeMenu())}).on(z,e+k,function(i){if(!(i.which>1)){var t=T(this),n=t.children(D),e=n[0];return e.play?e[t.hasClass(K)?vt:K]():ue(),!1}}).on(ht+h+ne,e+Ye,function(i){if(!(i.which>1)){var a=T(this),r=a.closest(e+le).find(D),t=r[0],n=a.getRect(),s=!!i.touches,l=!t.paused,o=function(e){t.currentTime=Math.range(0,(e-n.left)/(n.right-n.left)*t.duration,t.duration-.1)};t.pause(),r.triggerHandler("pause"),o(i.pageX),T(wt).on(s?Tt:Lt,function(t){o(t.pageX),t.preventDefault()}).one(s?ae:he,function(){T(this).off(s?Tt:Lt),l&&t.currentTime&&t.play(),i.preventDefault()})}})},o[Oe]=function(i,h){var A=T(Y+f);if(!A[0])return n.setTimeout(o[Oe].bind(o,i,h),1e3),l;if(o.waitScripts=0,o._readonly=/[?&]readonly(?:[=&]|$)/i.test(Wt.search),T.isArray(i)&&1===i.length&&(i=i[0]),T.isPlainObject(i)){var x,w,s,P,k=i.defaults||{};if(o.uuid=i._uuid,i.modules)for(s in i.modules)i.modules.hasOwnProperty(s)&&(o.abcModulesGlobal[s]=i.modules[s]);if(P=i,i._children)for(delete i.defaults,i=T.extend([],(w=i)._children),delete w._children,s=0;i.length>s;s++)x=i[s]._type,x===Fn||x===Hn?i.splice(s--,1):i[s]=T.extend(!0,{},w,k[x],i[s]);else i=[T.extend(!0,{},k[i._type],i)]}else if(!T.isArray(i))throw"Bad activity data";var C=Wt.hash;h=C?C.regex(/^#(?:urn:ABC:)?(.*)$/):h||0,T.isNumber(h)&&h>0&&i.length>=h&&(h=i[h-1]._id);for(var s=0;i.length>s&&h!==i[s]._id;s++)if(h===i[s]._path){h=i[s]._id;break}s===i.length&&(s=0,h=i[0]._id),o.CurrentActivity=s,o.handler=o.lastHandler=null,o.parent=T(Y+f).addClass(_i).append(o.$activities=Z(u,Ei)),T(Y+f).on(Kn,!1),o.$abcFooter=Z(u,yt,Z(be)).prependTo(o.parent),o[pe](),o[xi](),ni(A),define("cssReady",function(){"use strict";function t(e){return o.cssLoaded||o.themeLoaded?e(ut):s.push(e),t}var e=Z(g,"visibility:hidden;position:absolute;").appendTo(o.parent),i=0,n=0,a=Date.now(),s=[];return function h(){var r=e.width(),l=e.height();if(i!==r&&(i=r,o.cssLoaded=!0),n!==l&&(n=l,o.themeLoaded=!0),i&&n||Date.now()-a>2e3){o.cssLoaded=o.themeLoaded=!0,e.remove();for(var t=0,c=s.splice(0,s.length);c.length>t;t+=1)c[t](ut)}else T.rAF(h)}(),t.version="1.0.0",t.load=function(n,s,e,i){i.isBuild?e(null):t(e)},t}),define("domReady",function(){"use strict";function i(){if(!s&&(s=!0,e.length)){var t,i=e;for(e=[],t=0;i.length>t;t+=1)i[t](ut)}}function t(i){return s?i(ut):e.push(i),t}var s=!1,e=[];return"complete"===ut.readyState?i():(T(ut).on("DOMContentLoaded",i),T(n).on("load",i)),t.version="1.0.0",t.load=function(n,s,e,i){i.isBuild?e(null):t(e)},t});var s,c,d,y,I=function(t){o.handler[t.data](t)},O=function(){for(var e=0,s={};o.count>e;e++)o[e].doNotMark||(s["#activity_"+(e+1)]=o[e][t](["_path"],e));o.api(fi,s),o.api_started=!0;var a,l,c,h,i=o[V](_t).split("|"),d=[jt,dn,ln,L,Zt,Xt,Ut,Et,q,Ve,dt],n=function(s,l){var e,t,i,a,n;for(e=0;s.length>e;e++)t=s[e],n="?"===t[0],n&&(t=t.substr(1)),d.indexOf(t)>-1&&(i=t.ucfirst(),o.initList.push("check"+i),a=o["$abc"+i]=Z(Me,r+t).data(S,n?M:v).appendTo(l).on(z,null,"on"+i,I),t===L&&a.append(Z(g),Z(g)))};i[0]&&n(i[0].split(b),l=Z(g,q)),i[1]&&(c=Z(g,Wi,a=Z(g)),n(i[1].split(b),a)),i[2]&&n(i[2].split(b),h=Z(g,dt)),o.$abcFooter.append(c,l,h),o.initList.push("checkDisabled");var u=o.handler=Nt.shift();u.setTitle(),u[_]()},$=[bi+e+j];for(s=0;i.length>s;s++)d=i[s],y=d._type,y=y+"/"+y+(d[a]&&d[a][Ct]?e+d[a][Ct]:""),$.pushOnce(y);require($,function(){var a;for(Ee(),a=0;i.length>a;a++){if(d=i[a],c=o[a]=new o.ActivityTypes[d._type],o.count=a+1,c.index=a,c.data=d,c.baseId="#activity_"+(a+1),o[c.baseId]=c,c.buildTheme(),d._id===h&&(o.start=a,o.CurrentActivity=a),Nt.push(c),a||(o.commonPath=Wt.href.replace(/(\/[^\/]*)$/,"/")+c[p](bi+e+Ie).replace(/[^\/\\]*$/i,"")),d.modules)for(var s in d.modules)if(d.modules.hasOwnProperty(s)){o.abcModules[s]=o.abcModules[s]||null,o.abcModulesIndex[s]=o.abcModulesIndex[s]||[],c[m]=c[m]||{};var r=d.modules[s];T.isPlainObject(r)&&r.global&&(o.abcModules._data[s]=o.abcModules._data[s]||{},T.extend(!0,o.abcModules._data[s],r.global),r=r.data),c[m][s]={data:r,index:o.abcModulesIndex[s].length},o.abcModulesIndex[s].push(c.baseId)}var g=c[t]([ke]);if(g){T.currentHandler=c;var u=ut.createElement("script");u.type=Ce+Je+Pe+At,u.text="(function(activity){"+g+'}("'+c.baseId+'"))',o.parent[0].appendChild(u)}}var s,l=["domReady!","cssReady!"];for(s in o.abcModules)o.abcModules.hasOwnProperty(s)&&null===o.abcModules[s]&&(s=f+e+s+(e+j),l.push(""+s));l.length&&l.unshift("velocity-ui"),require(l,O,function(t){t&&(n.alert("Error loading required content!\n\nPlease reload page to prevent errors!"),T.log("RequireJS Load Error:",typeof t,t)),O()})})},o[Jt]=function(){var e=o.handler,n=o.$abcFooter.children(be),s=e[t]([i,_t])?"url('"+e[p](_t)+"')":"";n[0]&&n.data(pt)!==s&&n.css(pt,s).data(pt,s),e.initList()},o[_]=function(r,c){if(o.cssLoaded&&o.themeLoaded){r=Math.range(0,r,o.count-1);var h=o[r].data;if(h&&T.isString(h._type)&&o.ActivityTypes.hasOwnProperty(h._type)){var n,a,e=o[r],d=o.handler!==e;if(c=c||1,d&&(Qe(),n=o.lastHandler=o.handler),o.CurrentActivity=r,o.handler=e,e.visited||(e.visited=!0),a=e.context,n){var u=ut.activeElement;if(u&&"BODY"!==u.tagName&&T(u).blur(),n.timer(!1),!a.is(":visible")){var f=o.$activities[0];f.scrollLeft=f.scrollLeft+a.show().width()}a.position().left&&(n.context.css(W,1),a.velocity("scroll",{axis:"x",container:o.$activities,duration:$e*c,easing:o.momentum?[.02,Math.range(.01,o.momentum,.97),.47,1]:"swing",complete:function(){if(o[Jt](),n.context.css(W,""),n[y]()){var t=n.context,i=t.position(),s=o.$activities[0],e=0;0>i.left&&(e=t.width()),t.hide(),s.scrollLeft-=e,n===o.lastHandler&&(o.lastHandler=null)}}}))}else a.position().left&&(e.context.css(W,1),a.velocity("scroll",{axis:"x",container:o.$activities,duration:$e*c,easing:o.momentum?[.02,Math.range(.01,o.momentum,.97),.47,1]:"swing",complete:function(){e.context.css(W,"")}}));return e.setTitle(),o.started||o[Jt](),o[A](),(d||!o.started)&&(o.started=!0,e[s](Le)||e[s](Le,Date.now()),o.loadState||e[s](St)||!e[t]([i,"hideSubmit"],e.hideSubmit)||e[s]({progress:1,marked:!0}),o.api(Dt,e.baseId,n?n.baseId:null)),e[s](I)||e.timer(!0),l}}},o[A]=function(e,i){var t=i||o.handler;o.cssLoaded&&o.themeLoaded&&t&&t.context&&!t.loadingCount&&T.rAF(function(e,i){T.currentHandler=t,this.fixRatio(),this[A](this.fixHeaderFooter(),e===l?!0:e),o.api(Yt,this.baseId),this._visible||(this.context.css(vi,""),this._visible=!0),i&&this===o.handler&&(o.$activities[0].scrollLeft+=this.context.position().left)}.bind(t,e,o.resizeEvent))};var He,se,Ot;o[pe]=function(){var t=o.parent[0].clientHeight;return He!==t&&(He=t,se||(se=o[V]("lineCount",20)),Ot=t/se,o.emSize!==Ot&&(o.emSize=Ot,o.parent.css(ye,Ot+Kt),o.$activities.css(X,(t-o.$abcFooter.outerHeight(!0))/Ot+it))),Ot},o.resizeTime=0,T(n).on(ce,function(i){if(i.target===n&&o.handler&&o.handler.context){var t=Date.now(),e=t-o.resizeTime>500;e&&re(),o.api(ce,o.handler.baseId),o.resizeEvent=!0,o[A](e),o.resizeEvent=!1,o.resizeTime=t,o.resizeMenu()}}),T(ut).on(Xn,Y+f,function(){return!1}).on("webkit"+de+h+"moz"+de+h+de,function(){o[ve](ut.fullScreen||ut.mozFullScreen||ut.webkitIsFullScreen),o[A]()}),o[ve]=function(t){Modernizr.fullscreen&&(T.isBoolean(t)||(t=!Modernizr.prefixed(gs,ut)),t?(Modernizr.prefixed(Qi,o.parent[0])||T.noop)():(Modernizr.prefixed(tn,ut)||T.noop)(),o.parent.find(e+je).toggleClass(je+"-active",t))},o.initList=[],o.mouse={x:0,y:0},ut.addEventListener(Lt,Re,!0),ut.addEventListener(Tt,Re,!0),H.context=null,H.baseId="",H.content=null,H[O]=function(t,e){return this._type&&t.hasOwnProperty(this._type)?t[this._type].apply(this,T.isArray(e)?e:[].slice.call(arguments,1)):l},o[V]=H[V]=function(t,e){return n.abc.hasOwnProperty(t)?n.abc[t]:e},H.toEM=function(e,t){return t=t||0,e/o.emSize+t+it},H[w]=function(t,e,i){return(i||this.data).setTree(t,e)},H[s]=function(e,i){var n=!1,t=this.persistData,s=function(e,i){o.loadState||e===Se||e===Ct||!t.hasOwnProperty(e.split(".")[0])||t._loaded&&/^(pass|setpass|points|question)$/.test(e)||(t.setTree(e,i),n=!0)};if(T.isPlainObject(e))for(var a in e)s(a,e[a]);else{if(i===l)return t.getTree(e,"");this.doNotMark||s(e,i)}return n&&o.loaded&&!o._readonly&&t._loaded&&o.api(Mt,this.baseId,t),this},n.persist=function(n,a,r){var t,i=ut.getElementsByTagName("iframe");for(t=0;i.length>t;t++)try{if(i[t].contentWindow===n)return T(i[t]).closest(e+f).data(ze)[s](a,r)}catch(t){}},H[bt]=T.False,H[ls]=T.noop,H[t]=function(t,e,i){return(i||this.data).getTree(t,e)},H.has=function(t){return this.data.hasTree(t)},H[$]=function(i,n){var e=this[t](i,n),s=T.currentHandler;return T.currentHandler=this,e=e?(""+e).fromBBCode():"",T.currentHandler=s,e},H[pi]=function(){var e=this[t](["intro"])||this[t](["subtitle"])||this[t](["_name"],"")||Te;return e.replace(/(\[[^\]]*\])/g," ").replace(/\s\s/g," ").trim()},H[us]=function(t,e){return this[w](t,e,this.answers)},H[Vn]=function(e,i){return this[t](e,i,this.answers)},H[tt]=T.noop,H[y]=T.False,H[ct]=T.noop,H[Dn]=function(n,i){var e=this[t]([$n,n,1]);return e===i||T.isArray(e)&&e.indexOf(i)>=0?!0:!1},H[G]=T.noop,H.uniqueId=function(){return f+"_"+this.index+"_"+this.uniqueIdNumber++},H[st]=function(n){T.currentHandler=this;var e,i;for(e in this)!this.hasOwnProperty(e)||"$"!==e[0]&&"_"!==e[0]||delete this[e];this.answers={},this.uniqueIdNumber=0,i=parseFloat(this[t]([a,"font_size"],0)),this._autoSize={minSize:i||this[t]([a,"font_min_size"])||o[V]("minSize",50),maxSize:i||this[t]([a,"font_max_size"])||o[V]("maxSize",200)},n&&(this._type=this[t]([a,Ct],n)),(this.doNotMark||this[t]([a,"discussion"],!1))&&(this.hideSubmit=this.hideReset=this.hideReveal=!0),this.persistData={id:this[t](["_path"]),type:this.type+(this._type?" - "+this._type:""),pass:this[t]([a,Ge],-1),setpass:this[t]([a,on],-1),points:this[t]([a,St],-1),question:this[pi](),answers:[],attempts:0,auto:!0,marked:!1,max:0,min:0,progress:0,response:[],score:l,state:{},viewed:0,timer:0}},H[at]=function(){T.currentHandler=this,this._disabled=!1,this.content.empty().removeAttr("style").removeClass().addClass(It+h+r+this.type+(this._type?h+r+this.type+"-"+this._type:"")).siblings(rt).remove();var n,s=this.content.parent(),e=this[t]([i,"right_image"]);n=this[t]([i,"right_space"]),this.content.css("padding-right",n?n+"%":n),e&&Z(rt,"src="+this[p](e===!0?"right_image":e),"right:0",this[t]([i,"right_image_space"])&&n?"height:auto;width:"+n+"%;":null,"padding-left:"+this[t]([i,"right_image_left_padding"],0)+"em;padding-right:"+this[t]([i,"right_image_right_padding"],0)+"em;").prependTo(s),e=this[t]([i,"left_image"]),n=this[t]([i,"left_space"]),this.content.css("padding-left",n?n+"%":n),e&&Z(rt,"src="+this[p](e===!0?"left_image":e),"left:0",this[t]([i,"left_image_space"])&&n?"height:auto;width:"+n+"%;":null,"padding-left:"+this[t]([i,"left_image_left_padding"],0)+"em;padding-right:"+this[t]([i,"left_image_right_padding"],0)+"em").prependTo(s),e=this[t]([i,"background_image"]),e&&(this[t]([i,"background_image_full"])?this.context.css(pt,"url('"+this[p](e===!0?"background_image":e)+"')"):Z(rt,"src="+this[p](e===!0?"background_image":e),"left:0;right:0;width:100%").prependTo(s)),this.h1.html(this[$](["_name"],Te)),this.h2.html(this[$](["subtitle"],Te)),this.h3.toggle(!!this[t](["intro"])),this[t]([i,"text_shadow","content"])&&this.content.addClass("abc-text-shadow")},H.checkScore=function(){var t=this[s](St),e=o.$abcScore;-1===t&&(t=this[s](P)),e&&(e=e.toggleClass(e.data(S)?M:v,!t).children(),t&&(e.eq(0).text(this[s](I)?parseFloat((this[s](L)?t*Math.min(1,(this[s](L)+this[s](j))/(this[s](P)-this[s](j))):0).toFixed(1)):"-"),e.eq(1).text(t)))},H.onScore=function(){return!1},H.initList=function(){if(!this.initList.running){this.initList.running=!0;for(var t=0;o.initList.length>t;t++)this[o.initList[t]]();this.initList.running=!1}return this},H[A]=T.False,H[Rt]=function(){this.loadingCount||this.context.loading(!0),this.loadingCount=(this.loadingCount||0)+1},H[E]=function(){this.loadingCount--,this.loadingCount||(this._loaded=!0,o.api(ot,this.baseId,this.doNotMark?{}:this.persistData),this.context.loading(!1),o.started||this.index!==o.CurrentActivity||o[_](o.CurrentActivity),o[E]())},o[E]=function(){var i,t,n;if(!o._paused){for(i=0;o.count>i;i++)if(!o[i]._loaded)return;for(o.loadState=!0,o.parent.find(e+le+h+D).audio(),i=0;o.count>i;i++)t=o[i],n=t[s](I)&&!t.hideSubmit,t.persistData._loaded=!0,o.api(Mt,t.baseId,t.persistData),t[bt](n)!==!1&&n&&(t._btnSubmit=!0,t.onSubmit()),t.initList();o.loadState=!1,o.loaded=!0,o.api(li,o.handler.baseId),o._readonly&&(o.parent.find("["+Pt+"]").prop(Pt,bn),o.parent.find($t+b+Ze+ci).prop(d,en)),ge()}},H.timer=function(e,n){var t=this[s](te),i=Date.now();return o.api("timer",this.baseId,e,n)!==!1&&(e===!0?(this._timer=i,n&&(t=0)):e===!1&&this._timer&&(t+=(i-this._timer)/1e3,this._timer=0)),this._timer&&(t+=(i-this._timer)/1e3),o.loadState||this[s](te,t),1e3*t},H[fe]=function(h,c,v){if(c&&this.index===o.CurrentActivity&&!this.$feedback&&o.api(R,this.baseId,h,c,v)!==!1&&!this[t]([a,R])){var d=-1,m=Math.floor(100*h/c),w=this[t]([R],{});if(d=w.bestMatch(m),d!==l){var p,f,r,_=this[s](gt),b=Z(u,"abc-total",N+Sn+(v?m+Qt:h+" out of "+c),Z(is)),y=this[t]([i,R+"_duration"],0),x=this[ai].bind(this);for(f=T.isString(d)?d:d.text;T.isString(r=f.regex(/\{([^{]*?)\}/));)r=r.split("~"),r=r[Math.min(_,r.length)-1],r=r.split("|"),r=r[Math.floor(Math.random()*r.length)],f=f.replace(/(\{[^{]*?\})/,r.trim());for(v&&(h=m/10,c=10),p=0;c>p;p++)Z(g,"abc-stars",h>p?Hi:null).appendTo(b);return this.$feedback=Z(u,Q,"opacity:0",Z(xe,N+f.fromBBCode()),this[t]([i,R+"_stars"],!0)?b:null).data(Q,Date.now()).appendTo(this.context).modal(!0,y).autoTextSize().position({my:"center",at:"center",of:this.context}).velocity("fadeIn",y,function(){this.context.one(z+e+Q,x);var s=this[t]([i,R+"_delay"],5);s&&this.$feedback.data("delay",n.setTimeout(x,1e3*s))}.bind(this)),!0}}return!1},H[ai]=function(){var s=this.$feedback;s&&Date.now()-s.data(Q)>100&&(this.$feedback=null,n.clearTimeout(s.data("delay")),this.context.off(e+Q),s.modal(!1).velocity(ii,this[t]([i,R+"_duration"],0),function(){s.remove()}.bind(this)))},H.countLeft=function(i,n){var t,e=0;for(t=0;this.index>t;t++)ie(o[t],i,n)&&e++;return e},H.getLeft=function(){for(var t=this.index-1;t>=0&&o[t][y]();)t--;return t>=0&&!o[t][y]()?t:!1},H.countTotal=function(i,n){var t,e=0;for(t=0;o.count>t;t++)ie(o[t],i,n)&&e++;return e},H.countRight=function(i,n){var t,e=0;for(t=o.count-1;t>this.index;t--)ie(o[t],i,n)&&e++;return e},H.getRight=function(){for(var t=this.index+1;o.count>t&&o[t][y]();)t++;return o.count>t&&!o[t][y]()?t:!1},H.complete=!1,H.checkDisabled=function(){this.content.toggleClass(hn,this._disabled)},H.defaultFullscreen=!0,H.hideFullscreen=!1,H.checkFullscreen=function(){return this.onFullscreen(this.defaultFullscreen,!Modernizr.fullscreen||this.hideFullscreen||!this[t]([a,jt]));
},H.onFullscreen=function(t,e){if(this===o.handler&&o.$abcFullscreen)if(T.isBoolean(t)){var i=o.$abcFullscreen.toggleClass(d,!t);T.isBoolean(e)&&i.toggleClass(i.data(S)?M:v,!!e),this._btnFullscreen=t}else this._btnFullscreen!==!1&&o[ve]();return this},H.defaultHelp=!1,H.hideHelp=!1,H.checkHelp=function(){return this.onHelp(!!this[t](["helpText"]),this.hideHelp||this[t]([i,"hideHelp"],!1))},H.onHelp=function(e,i){if(this===o.handler&&o.$abcHelp)if(T.isBoolean(e)){var n=o.$abcHelp.toggleClass(d,!e);T.isBoolean(i)&&n.toggleClass(n.data(S)?M:v,!!i),this._btnHelp=e}else if(this._btnHelp!==!1){var s=this[t](["helpText"]);if(s){this.dialog(null,s,"Close")}}return this},H.defaultPrint=!1,H.hidePrint=!1,H.checkPrint=function(){return this.onPrint(this.defaultPrint,this.hidePrint||this[t]([i,"hidePrint"],!1))},H.onPrint=function(t,e){if(this===o.handler&&o.$abcPrint)if(T.isBoolean(t)){var i=o.$abcPrint.toggleClass(d,!t);T.isBoolean(e)&&i.toggleClass(i.data(S)?M:v,!!e),this._btnPrint=t}else this._btnPrint!==!1&&n.print();return this},H.defaultSubmit=!1,H.hideSubmit=!1,H.checkSubmit=function(e){var n=this[s](I)&&this[s](P)===this[s](L)&&this[t]([i,"disablePerfectSubmit"]);return this.onSubmit(this[s](I)||this._disabled?!1:!n&&!this[t]([i,"disableSubmit"],!this._disabled&&(T.isBoolean(e)?e:!this.defaultSubmit)),this[t]([i,"hideSubmit"],this.hideSubmit))},H.onSubmit=function(i,n){if(T.isBoolean(i)){var r=this[t]([a,ti],0);if(r&&(i=r>this[s](gt)?i:!1),o._readonly&&!o.loadState&&(i=!1),this._btnSubmit=i,this===o.handler&&o.$abcSubmit){var l=o.$abcSubmit.toggleClass(d,!i);T.isBoolean(n)&&l.toggleClass(l.data(S)?M:v,!!n)}}else if(this._btnSubmit!==!1){var c=function(t){t||(o.api(Zt,this.baseId),this.timer(!1),T(e+x,this.content).removeClass(x),this._disabled=this.complete=!0,this._revealed=!1,this.context.addClass(d),o.loadState||this[s]({marked:!0,attempts:this[s](gt)+1}),this[G](),this.initList())}.bind(this);!o.loadState&&this[t](["settings","confirm"])?this.dialog(this[$]([a,"confirm_title"],"Confirm Submit"),this[$]([a,"confirm_text"],"Are you sure you wish to submit your answers?"),["Yes","No"],c):c()}return this},H.defaultReset=!0,H.hideReset=!1,H.checkReset=function(e){var n=this[s](I),a=!n&&this[t]([i,"disableMarkedReset"]),r=n&&this[s](P)===this[s](L)&&this[t]([i,"disablePerfectReset"]);return this.onReset(!a&&!r&&!this[t]([i,"disableReset"],!this._disabled&&(T.isBoolean(e)?e:!this.defaultReset)),this[t]([i,"hideReset"],this.hideReset))},H.onReset=function(i,n){if(T.isBoolean(i)){var r=this[t]([a,ti],0);if(r&&(i=r>this[s](gt)?i:!1),o._readonly&&(i=!1),this._btnReset=i,this===o.handler&&o.$abcReset){var l=o.$abcReset.toggleClass(d,!i);T.isBoolean(n)&&l.toggleClass(l.data(S)?M:v,!!n)}}else this._btnReset!==!1&&(o.api(Xt,this.baseId),this.timer(!0,!0),this.content.removeClass(nn),T(e+x,this.content).removeClass(x),T(e+J,this.content).removeClass(J),T(e+nt,this.content).removeClass(nt),T(e+mt,this.content).removeClass(mt),this._disabled=this._revealed=this.complete=!1,this.context.removeClass(d),this[ct](),this.answers={},T.each([J,nt,mt],function(i,t){T(e+t+":not("+e+rn+")",this.content).removeClass(t)}),this[s]({marked:!1,progress:0,score:0,response:[],state:{}}).initList());return this},H.defaultReveal=!0,H.disableReveal=!1,H.hideReveal=!1,H.checkReveal=function(e){var n=this[s](I)&&this[s](P)===this[s](L)&&this[t]([i,"disablePerfectReveal"]),a=this._disabled&&this._revealed&&this[t]([i,"disableSingleReveal"]);return this.onReveal(!n&&!a&&!this[t]([i,"disableReveal"],!this._disabled&&(T.isBoolean(e)?e:!this.defaultReveal)),this[t]([i,"hideReveal"],this.hideReveal))},H.onReveal=function(i,n){if(T.isBoolean(i)){var r=this[t]([a,"reveal_after"]);if(r&&(i=r>this[s](gt)?!1:i),this.disableReveal&&(i=!1),o._readonly&&(i=!1),this._btnReveal=i,this===o.handler&&o.$abcReveal){var l=o.$abcReveal.toggleClass(d,!i);T.isBoolean(n)&&l.toggleClass(l.data(S)?M:v,!!n)}}else this._btnReveal!==!1&&o.api(Ut,this.baseId)!==!1&&(T(e+x,this.content).removeClass(x),T(e+J,this.content).removeClass(J),T(e+nt,this.content).removeClass(nt),this._disabled=this._revealed=!0,this.complete=!0,this.context.addClass(d),this[tt](),this.initList());return this},o.lastFirst=-1,H.defaultFirst=!0,H.hideFirst=!1,H.checkFirst=function(){if(this===o.handler&&o.$abcFirst){var e=!1,n=!!this[t]([a,"letters_first"]),s=!!this[t]([a,"letters"]);e=n&&s?!0:0===this.countLeft(),e||(o.lastFirst=this.index),o.$abcFirst.toggleClass("abc-return",o.lastFirst>=0&&e),this.onFirst(!this[t]([i,"disableFirst"])&&(!e||o.lastFirst>=0),this[y]()||this.countTotal()<=1||!this[t]([i,"showFirst"])||e&&this[t]([i,"hideFirst"])&&0>o.lastFirst)}return this},H.onFirst=function(i,r){var l=this===o.handler&&o.$abcFirst;if(T.isBoolean(i)){if(l){this._btnFirst=i;var c=o.$abcFirst.toggleClass(d,!i);T.isBoolean(r)&&c.toggleClass(c.data(S)?M:v,!!r)}}else if(l&&this._btnFirst!==!1&&o.api(Et,this.baseId)!==!1){var e,n=-1,s=this[t]([a,"letters_first"]);if(!s||!this[t]([a,"letters"]))for(e=0;this.index>e&&(o[e][y]()||s&&!o[e][t]([a,"letters"])||(n=e,s));e++);n>=0?(o.lastFirst=this.index,o[_](n)):o.lastHandler&&o[_](o.lastFirst)}return this},H.defaultLeft=!0,H.hideLeft=!1,H.checkLeft=function(){return this.onLeft(this.countLeft()>0&&!this[t]([i,"disableLeft"]),this.countTotal()<=1||this[y]()||this[t]([i,"hideLeft"],!1))},H.onLeft=function(t,e){var i=this===o.handler&&o.$abcLeft;if(T.isBoolean(t)){if(this._btnLeft=t,i){var n=o.$abcLeft.toggleClass(d,!t);T.isBoolean(e)&&n.toggleClass(n.data(S)?M:v,!!e)}}else if(i&&this._btnLeft!==!1&&o.api(q,this.baseId)!==!1){var s=this.getLeft();s!==!1&&o[_](s)}return this},H.defaultNav=!0,H.hideNav=!1,H.checkNav=function(){if(this===o.handler&&o.$abcNav){T.currentHandler=this,o.$abcNav.html("<span>"+this[$]([i,"nav_button"],"[activitycount!]")+"</span>");var e=this.countTotal();this.onNav(!this[t]([i,"ordered"])&&e>1,1>=e||this[y]()||this[t]([i,"hideNav"],!1))}return this},o.resizeMenu=function(){if(o.$abcMenu)for(var i,s=o.handler,n=s.countLeft(),t=n-2,e=s.countRight()-2,a=o.$abcMenu,r=a[0],l=a.children(Me).removeClass(v),c=r.clientWidth;r.scrollWidth>c;){if(e>=2&&e>=t)i=n+e--;else if(t>=2)i=n-t--;else if(e>0&&e>=t)i=-1-e--;else if(t>0)i=t--;else if(0===e&&e>=t)i=n+1,e--;else{if(0!==t)break;i=n-1,t--}l.eq(i).addClass(v)}},o.closeMenu=function(){o.$abcMenu&&o.$abcMenu.velocity({height:"0"},function(){o.$abcMenu.remove(),o.$abcNav.removeClass(Fe+"-open"),delete o.$abcMenu,o.$abcFooter.css(W,"")})},o.clickMenu=function(t){return 2>t.which&&!T(t.target).hasClass(d)&&t.data!==o.CurrentActivity?(o.closeMenu(),o.momentum=0,o[_](t.data),!1):l},H.onNav=function(i,n){var s=this===o.handler&&o.$abcNav;if(T.isBoolean(i)){if(this._btnNav=i,s){var r=o.$abcNav.toggleClass(d,!i);T.isBoolean(n)&&r.toggleClass(r.data(S)?M:v,!!n)}}else if(s&&this._btnNav!==!1){var e,l,c=0,h=0;if(o.$abcMenu)o.closeMenu();else{for(o.$abcMenu=Z(u,mn),e=0;o.count>e;e++)o[e][y]()||(l=o[e][$]([a,"pageNumber"],o[e].navigationTitle)||(o[e][t]([a,"letters"])?String.fromCharCode(97+c++):++h),Z(Me,e===this.index?d:null,o[e].complete?Di:null,Z(g,N+l)).appendTo(o.$abcMenu).on(z,null,e,o.clickMenu));o.$abcMenu.prependTo(o.$abcFooter.css(W,1)).velocity({height:[o.$abcMenu.css(X),0]},function(){o.$abcNav.addClass(Fe+"-open")}),o.resizeMenu()}}return this},H.defaultRight=!0,H.hideRight=!1,H.checkRight=function(){return this.onRight(this.countRight()>0&&!this[t]([i,"disableRight"])&&(this[s](I)||!this[s](P)||!this[t]([i,"disableRightSubmit"])),this.countTotal()<=1||this[y]()||this[t]([i,"hideRight"],!1))},H.onRight=function(t,e){var i=this===o.handler&&o.$abcRight;if(T.isBoolean(t)){if(this._btnRight=t,i){var n=o.$abcRight.toggleClass(d,!t);T.isBoolean(e)&&n.toggleClass(n.data(S)?M:v,!!e)}}else if(i&&this._btnRight!==!1&&o.api(dt,this.baseId)!==!1&&this.index===o.CurrentActivity){var s=this.getRight();s!==!1&&o[_](s)}return this},H.fixHeaderFooter=function(){var e=o.$activities[0],i=e.clientWidth,n=e.clientHeight,t=this.header.outerHeight(),s=this._headerHeight!==t;return s||this._parentWidth!==i||this._parentHeight!==n?(this._parentWidth=i,this._parentHeight=n,s&&(this._headerHeight=t,this.contentBox.css(Ne,t/o.emSize+it)),!0):!1},H.fixRatio=function(){var a,e,s,r;for(a=o.parent;!e||!s;a=a.parent())r=n.getComputedStyle(a[0],null),e=e||a.convertCSS(r[ei],!0),s=s||a.convertCSS(r[ri]),a.is(qt)&&(e=e||a.width(),s=s||a.height());if(o._fixRatioWidth!==e||o._fixRatioHeight!==s){o._fixRatioWidth=e,o._fixRatioHeight=s;var l=this[t]([i,F],0),c=this[t]([i,X],0);if(l&&c){var d=o.parent.is(wt)&&"parentIFrame"in n,h=Math.floor(l*(s/c)),u=Math.floor(c*(e/l));d?n.parentIFrame.size(Math.min(h,e),Math.min(u,s)):o.parent.css(F,Math.min(h,e)).css(X,Math.min(u,s))}return o[pe](),!0}return!1},o[p]=H[p]=function(t){var e,s;t="/"+t+(t.indexOf(".")>0?"":".");var e,i,s="",a=(this===o?"":"/"+(this.index+1))+t;for(e=0;n.assets.length>e;e++)i=n.assets[e],i.indexOf(i.indexOf("_common")>=0?t:a)>=0&&(s=i);return s};var oe=Wt.protocol;oe=/^https?:/.test(oe)?oe:cs+c,H.buildTheme=function(){var s,n,r=function(a,t,e){var i=a+(t||e?"_":"")+(t||"")+(e||""),n=this[p](i+as),s=this[p](i+rs);(n||s)&&T.stylesheet("@font-face /*"+i+"*/",[et+c+"'"+a+"'",$i+(n?c+"url('"+n+"') format('woff'),":"")+(s?"url('"+s+"') format('truetype')":""),zi+c+(t||yi),Ri+c+(e||yi)])}.bind(this),d=function(){r(C),r(C,qe),r(C,null,mi),r(C,qe,mi)}.bind(this);if(r(gn),n=this[t]([i,C]),n&&!o.parent[0].style[et]){if(n===!0)d(),n=C;else{var l,a,u,f=n.split("&");for(n=null,l=0;f.length>l;l++)u=f[l],a=u.split(c).shift().replace(/\+/gi," "),"*"===a?(d(),a=C):T(Ue+":abc(font,"+a+")")[0]||Z(Ue,"rel=stylesheet","type=text/css","href=http"+(/^https?:/.test(Wt.protocol)?"s":"")+"://fonts.googleapis.com/css?family="+u.replace(/\s/g,"+")).data(C,a).appendTo("head"),n||(n=a)}o.parent.css(et,"'"+n+"', sans-serif")}for(n=this[t]([i,"colour"]),n&&(T.stylesheet(e+xt+h+_e,U+c+n,this.baseId),T.stylesheet(e+yt,U+c+n,this.baseId),T.stylesheet(e+It,ft+c+n,this.baseId),T.stylesheet(e+Q,ft+c+n,this.baseId)),n=this[t]([i,"colourback"]),n&&(T.stylesheet(e+xt+h+_e,B+c+n,this.baseId),T.stylesheet(e+yt,B+c+n,this.baseId)),n=this[t]([i,"colour2"]),n&&T.stylesheet(e+xt+h+we,U+c+n,this.baseId),n=this[t]([i,"colour2back"]),n&&T.stylesheet(e+xt+h+we,B+c+n,this.baseId),n=this[t]([i,"colours"],[]),s=0;n.length>s;s++)s||T.stylesheet(e+Ae+b+e+Ae+c+ns+b+e+Ae+c+ss,ft+c+n[s][0],this.baseId),T.stylesheet(e+lt+(s+1),[U+c+n[s][0],ft+c+n[s][0],B+c+n[s][1]],this.baseId),T.stylesheet(e+Ji+(s+1)+b+e+Bt+e+lt+(s+1)+b+e+lt+(s+1)+h+Bt+b+e+mt+e+lt+(s+1),[U+c+n[s][1],ft+c+n[s][0],B+c+n[s][0]],this.baseId),T.stylesheet(e+Be+(s+1),[qi+c+"inset 0 0 0 3px "+n[s][0],U+c+n[s][1]],this.baseId);n=this[t]([i,Oi],{});for(s in n)n.hasOwnProperty(s)&&T.stylesheet(s.replace(/&/g,this.baseId),n[s])},H.dialog=function(n,r,t,s){t=T.isArray(t)?t:[t];var e,i,o=this,a=Z(u,cn,Z(!!n,xe,N+n),Z(u,Z(u,N+r.fromBBCode())),t&&t.length?i=Z(u,Ki):null).appendTo(this.context).modal(!0).autoTextSize();if(t&&t.length){for(e=0;t.length>e;e++)Z(zt,Vi,ee,N+t[e]).on(he+h+ae,function(t){2>t.which&&(s&&s.call(o,T(this).index()),a.modal(!1).remove(),t.preventDefault())}).appendTo(i);i.children().last().focus()}return a},H.setTitle=function(){ut.title=(this.data._name||this.data._path||"Activity").replace(/(\[.*?\])/gi,"")};return H[_]=function(){T.currentHandler=this,De.call(this),o.parent.addClass(this[t]([i,"classname"]));var e=this[t]([i,"show_title"],!0);this.content=Z(u,It),this.context=Z(u,this.baseId,f,vi+":"+v,o._readonly?d:"").data(ze,this).data(Se,this.data[Tn]||this.data[Ii]).data(Xe,this.index).appendTo(o.$activities),this.context.append(this.header=Z(u,xt,Z(e,u,Z(e,rt,"src="+this[p]("logo")),this.btnClose,Z(e,_e,this.h1=Z(g)),Z(e,we,this.h2=Z(g))),Z(xe,this.h3=Z(g,N+this[$](["intro"],"")),this[t]([i,"banner"])?pt+":url('"+this[p]("banner")+"')":null)),this.contentBox=Z(u,an,this.content));for(var n in this[m])this[m].hasOwnProperty(n)&&this.context.addClass(vn+"-"+n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase());this[st](),this[Rt](),this[at](),this.context.css(et)!==this.context.parent().css(et)&&(this[Rt](),this.context.onFontLoaded(this[E].bind(this))),this[E](),Nt.length&&(Vt+250>Date.now()?Nt.shift()[_]():T.rAF(function(){Vt=Date.now(),Nt.shift()[_]()}))},require([ps],function(){n.jQuery=n.$=T,T(At).each(function(i){var t=T(this),e=t.text();if(/^\s*".*"\s*$/.test(e)){try{o[Oe](JSON.parse(atob(e.replace(/[^a-z0-9\+\/]/gi,"").reverse())))}catch(t){return}return t.remove(),!1}})}),o}),define("fill_the_gaps/fill_the_gaps.dropdown",[Nt,Ke,ie,fs],function(n,l,o,i){var r=Pn;return i.defaultText="&nbsp;&#x25BE;&nbsp;",i[st][r]=function(){this.content.on("click",".abc-choice > button",this.onChoiceButton.bind(this)).on("click",".abc-choice > button + span > button",this.onChoiceButtonSpanButton.bind(this))},i.onChoiceButton=function(i){if(!this._disabled){var t=n(i.currentTarget);if(this.content.find(e+x).not(t).removeClass(x),t.toggleClass(x).hasClass(x)){var s=t.next().css(F,"");s.css(F,Math.ceil(parseFloat(s.css(F)))).position({my:"left top",at:"left bottom",of:t.parent(),collision:"fit",within:t.closest(u)})}this.content.children().autoTextSize(this._autoSize)}i.stopPropagation()},i.onChoiceButtonSpanButton=function(t){if(!this._disabled){var e=n(t.currentTarget),r=e.text();e.parent().prev().removeClass(x+h+se+"-1").addClass(Z+"-1").text(r),this.content.children().autoTextSize(this._autoSize);var i=!1,a=[];this.$buttons.each(function(e){var t=n(this);t.hasClass(Z+"-1")&&(i=!0,a[e]=t.text())}),this[s](oi,i?a:[]).initList()}t.stopPropagation()},i[bt][r]=function(i){var e,t=this[s](oi)||[];t.length&&this.$buttons.each(function(s){t[s]&&(e=i?t[s].replace(/^\(\(|\)\)$/g,""):t[s],n(this).removeClass(x+h+se+"-1").addClass(Z+"-1").text(e))})},i.checkReset[r]=function(){return!this.$buttons.filter(e+Z+"-1").length},i.checkSubmit[r]=function(){return this.$buttons.length!==this.$buttons.filter(e+Z+"-1").length},i[at][r]=function(){var i,n=this[$](["text"],""),r=this[t]([a,"random"],!0);i=n.replace(/(<embed.*?\/>|\{[^\{]*?\})/gi,function(i,t){if("{"!==t[0])return t;t=t.replace(/(^{\s*|\s*})/g,""),"~"!==t[0]&&this._values.push(t.replace(/(<[^>]*>|~.*$)/g,"").split(/\s*\|\s*/));var e=t.split(/\s*[~\|]\s*/);return e[0].length||e.splice(1),r&&e.shuffle(),'<span class="abc-choice"><button class="abc-colour-1"></button><span><button class="abc-background-1">'+e.join('</button><button class="abc-background-1">')+"</button></span></span>"}.bind(this)),this[s]({answers:this._values,max:this._values.length});l(u,N+i).appendTo(this.content);this.$buttons=this.content.find(e+Gi+">"+zt)},i[A][r]=function(i,t){t&&n(e+x,this.content).removeClass(x)},i[ct][r]=function(){n(".abc-choice > button",this.content).removeData("value").removeClass(He).addClass(ee).empty()},i[tt][r]=function(){n(".abc-choice > button",this.content).removeClass(He).addClass(mt+h+ee).each(function(t,e){n(e).text(this._values[t][0]||"")}.bind(this)),this.content.children().autoTextSize(this._autoSize)},i[G][r]=function(){var t=0,e=0,i=[],a=this._values;n(".abc-choice > button",this.content).each(function(o){var r=n(this),s=r.text();a[o].indexOf(s)>=0?(r.addClass(J),t++):a[o].length&&(r.addClass(nt),s="(("+s+"))",e++),i.push(s)}),o.loadState||(this[s]({score:t,progress:1,response:i}),o.api(L,this.baseId,t,t+e,i)!==!1&&this[fe](t,t+e))},i}),!function(e){"use strict";function w(t,i,n){"addEventListener"in e?t.addEventListener(i,n,!1):"attachEvent"in e&&t.attachEvent("on"+i,n)}function ot(t,i,n){"removeEventListener"in e?t.removeEventListener(i,n,!1):"detachEvent"in e&&t.detachEvent("on"+i,n)}function ut(t){return t.charAt(0).toUpperCase()+t.slice(1)}function vt(a){var e,i,s,t=null,n=0,r=function(){n=_(),t=null,s=a.apply(e,i),t||(e=i=null)};return function(){var o=_();n||(n=o);var l=g-(o-n);return e=this,i=arguments,0>=l||l>g?(t&&(clearTimeout(t),t=null),n=o,s=a.apply(e,i),t||(e=i=null)):t||(t=setTimeout(r,l)),s}}function t(t){}function d(t){}function yt(){wt(),t("Initialising iFrame ("+location.href+")"),_t(),Lt(),C("background",tt),C("padding",rt),It(),q(),lt(),pt(),ft(),et(),v=Pt(),u("init","Init message from host page"),R()}function wt(){function e(t){return"true"===t?!0:!1}var t=D.substr(X).split(":");T=t[0],I=void 0!==t[1]?+t[1]:I,b=void 0!==t[2]?e(t[2]):b,J=void 0!==t[3]?e(t[3]):J,h=void 0!==t[4]?+t[4]:h,r=void 0!==t[6]?e(t[6]):r,S=t[7],n=void 0!==t[8]?t[8]:n,tt=t[9],rt=t[10],A=void 0!==t[11]?+t[11]:A,v.enable=void 0!==t[12]?e(t[12]):!1,$=void 0!==t[13]?t[13]:$,s=void 0!==t[14]?t[14]:s}function _t(){function i(){var i=e.iFrameResizer;t("Reading data from page: "+JSON.stringify(i)),z="messageCallback"in i?i.messageCallback:z,R="readyCallback"in i?i.readyCallback:R,m="targetOrigin"in i?i.targetOrigin:m,n="heightCalculationMethod"in i?i.heightCalculationMethod:n,s="widthCalculationMethod"in i?i.widthCalculationMethod:s}"iFrameResizer"in e&&Object===e.iFrameResizer.constructor&&i(),t("TargetOrigin for parent set to: "+m)}function St(e,t){return-1!==t.indexOf("-")&&(d("Negative CSS value ignored for "+e),t=""),t}function C(i,e){void 0!==e&&""!==e&&"null"!==e&&(o.body.style[i]=e,t("Body "+i+' set to "'+e+'"'))}function Lt(){void 0===S&&(S=I+"px"),C("margin",St("margin",S))}function pt(){o.documentElement.style.height="",o.body.style.height="",t('HTML & body height set to "auto"')}function i(i){function n(){u(i.eventName,i.eventType)}var s={add:function(t){w(e,t,n)},remove:function(t){ot(e,t,n)}};i.eventNames&&Array.prototype.map?(i.eventName=i.eventNames[0],i.eventNames.map(s[i.method])):s[i.method](i.eventName),t(ut(i.method)+" event listener: "+i.eventType)}function dt(t){i({method:t,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),i({method:t,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),i({method:t,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),i({method:t,eventType:"Input",eventName:"input"}),i({method:t,eventType:"Mouse Up",eventName:"mouseup"}),i({method:t,eventType:"Mouse Down",eventName:"mousedown"}),i({method:t,eventType:"Orientation Change",eventName:"orientationchange"}),i({method:t,eventType:"Touch Start",eventName:"touchstart"}),i({method:t,eventType:"Touch End",eventName:"touchend"}),i({method:t,eventType:"Touch Cancel",eventName:"touchcancel"}),i({method:t,eventType:"Print",eventName:["afterprint","beforeprint"]}),i({method:t,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),i({method:t,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),i({method:t,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===$&&i({method:t,eventType:"IFrame Resized",eventName:"resize"})}function K(e,i,s,n){return i!==e&&(e in s||(d(e+" is not a valid option for "+n+"CalculationMethod."),e=i),t(n+' calculation method set to "'+e+'"')),e}function q(){n=K(n,O,l,"height")}function lt(){s=K(s,at,c,"width")}function et(){!0===r?(dt("add"),mt()):t("Auto Resize disabled")}function Tt(){t("Disable outgoing messages"),G=!1}function Ot(){t("Remove event listener: Message"),ot(e,"message",Y)}function At(){null!==M&&M.disconnect()}function B(){dt("remove"),At(),clearInterval(j)}function kt(){Tt(),Ot(),!0===r&&B()}function It(){var t=o.createElement("div");t.style.clear="both",t.style.display="block",o.body.appendChild(t)}function Pt(){function s(){return{x:void 0!==e.pageXOffset?e.pageXOffset:o.documentElement.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:o.documentElement.scrollTop}}function r(i){var t=i.getBoundingClientRect(),e=s();return{x:parseInt(t.left,10)+parseInt(e.x,10),y:parseInt(t.top,10)+parseInt(e.y,10)}}function i(i){function l(n){var i=r(n);t("Moving to in page link (#"+e+") at x: "+i.x+" y: "+i.y),a(i.y,i.x,"scrollToOffset")}var e=i.split("#")[1]||i,n=decodeURIComponent(e),s=o.getElementById(n)||o.getElementsByName(n)[0];void 0!==s?l(s):(t("In page link (#"+e+") not found in iFrame, so sending to parent"),a(0,0,"inPageLink","#"+e))}function n(){""!==location.hash&&"#"!==location.hash&&i(location.href)}function l(){function t(t){function e(t){t.preventDefault(),i(this.getAttribute("href"))}"#"!==t.getAttribute("href")&&w(t,"click",e)}Array.prototype.forEach.call(o.querySelectorAll('a[href^="#"]'),t)}function c(){w(e,"hashchange",n)}function h(){setTimeout(n,L)}function u(){Array.prototype.forEach&&o.querySelectorAll?(t("Setting up location.hash handlers"),l(),c(),h()):d("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return v.enable?u():t("In page linking not enabled"),{findTarget:i}}function ft(){t("Enable public methods"),$t.parentIFrame={autoResize:function(t){return!0===t&&!1===r?(r=!0,et()):!1===t&&!0===r&&(r=!1,B()),r},close:function(){a(0,0,"close"),kt()},getId:function(){return T},getPageInfo:function(t){"function"==typeof t?(F=t,a(0,0,"pageInfo")):(F=t,a(0,0,"pageInfoStop"))},moveToAnchor:function(t){v.findTarget(t)},reset:function(){W("parentIFrame.reset")},scrollTo:function(t,e){a(e,t,"scrollTo")},scrollToOffset:function(t,e){a(e,t,"scrollToOffset")},sendMessage:function(t,e){a(0,0,"message",JSON.stringify(t),e)},setHeightCalculationMethod:function(t){n=t,q()},setWidthCalculationMethod:function(t){s=t,lt()},setTargetOrigin:function(e){t("Set targetOrigin: "+e),m=e},size:function(t,e){var i=""+(t?t:"")+(e?","+e:"");u("size","parentIFrame.size("+i+")",t,e)}}}function U(){0!==h&&(t("setInterval: "+h+"ms"),j=setInterval(function(){u("interval","setInterval: "+h)},Math.abs(h)))}function gt(){function p(e){function i(e){!1===e.complete&&(t("Attach listeners to "+e.src),e.addEventListener("load",r,!1),e.addEventListener("error",l,!1),n.push(e))}"attributes"===e.type&&"src"===e.attributeName?i(e.target):"childList"===e.type&&Array.prototype.forEach.call(e.target.querySelectorAll("img"),i)}function d(t){n.splice(n.indexOf(t),1)}function s(e){t("Remove listeners from "+e.src),e.removeEventListener("load",r,!1),e.removeEventListener("error",l,!1),d(e)}function a(t,e,i){s(t.target),u(e,i+": "+t.target.src,void 0,void 0)}function r(t){a(t,"imageLoad","Image loaded")}function l(t){a(t,"imageLoadFailed","Image load failed")}function c(t){u("mutationObserver","mutationObserver: "+t[0].target+" "+t[0].type),t.forEach(p)}function h(){var e=o.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return i=new f(c),t("Create body MutationObserver"),i.observe(e,n),i}var n=[],f=e.MutationObserver||e.WebKitMutationObserver,i=h();return{disconnect:function(){"disconnect"in i&&(t("Disconnect body MutationObserver"),i.disconnect(),n.forEach(s))}}}function mt(){var i=0>h;e.MutationObserver||e.WebKitMutationObserver?i?U():M=gt():(t("MutationObserver not supported in this browser!"),U())}function k(i,t){function n(e){var i=/^\d+(px)?$/i;if(i.test(e))return parseInt(e,Q);var n=t.style.left,s=t.runtimeStyle.left;return t.runtimeStyle.left=t.currentStyle.left,t.style.left=e||0,e=t.style.pixelLeft,t.style.left=n,t.runtimeStyle.left=s,e}var e=0;return t=t||o.body,"defaultView"in o&&"getComputedStyle"in o.defaultView?(e=o.defaultView.getComputedStyle(t,null),e=null!==e?e[i]:0):e=n(t.currentStyle[i]),parseInt(e,Q)}function bt(e){e>g/2&&(g=2*e,t("Event throttle increased to "+g+"ms"))}function P(r,n){for(var o=n.length,s=0,a=0,l=ut(r),e=_(),i=0;o>i;i++)s=n[i].getBoundingClientRect()[r]+k("margin"+l,n[i]),s>a&&(a=s);return e=_()-e,t("Parsed "+o+" HTML elements"),t("Element position calculated in "+e+"ms"),bt(e),a}function y(t){return[t.bodyOffset(),t.bodyScroll(),t.documentElementOffset(),t.documentElementScroll()]}function nt(i,t){function n(){return d("No tagged elements ("+t+") found on page"),f}var e=o.querySelectorAll("["+t+"]");return 0===e.length?n():P(i,e)}function st(){return o.querySelectorAll("body *")}function Mt(e,g,h,o){function u(){f=r,p=i,a(f,p,e)}function d(){function t(t,e){var i=Math.abs(t-e)<=A;return!i}return r=void 0!==h?h:l[n](),i=void 0!==o?o:c[s](),t(f,r)||b&&t(p,i)}function x(){return!(e in{init:1,interval:1,size:1})}function m(){return n in V||b&&s in V}function v(){t("No change in size detected")}function y(){x()&&m()?W(g):e in{interval:1}||v()}var r,i;d()||"init"===e?(ht(),u()):y()}function u(e,i,n,s){function a(){e in{reset:1,resetPage:1,init:1}||t("Trigger event: "+i)}function r(){return x&&e in xt}r()?t("Trigger event cancelled: "+e):(a(),Ct(e,i,n,s))}function ht(){x||(x=!0,t("Trigger event lock on")),clearTimeout(it),it=setTimeout(function(){x=!1,t("Trigger event lock off"),t("--")},L)}function N(t){f=l[n](),p=c[s](),a(f,p,t)}function W(e){var i=n;n=O,t("Reset trigger event: "+e),ht(),N("reset"),n=i}function a(n,s,a,i,e){function r(){void 0===e?e=m:t("Message targetOrigin: "+e)}function o(){var o=n+":"+s,r=T+":"+o+":"+a+(void 0!==i?":"+i:"");t("Sending message to host page ("+r+")"),Z.postMessage(H+r,e)}!0===G&&(r(),o())}function Y(i){function c(){return H===(""+i.data).substr(0,X)}function l(){D=i.data,Z=i.source,yt(),ct=!1,setTimeout(function(){E=!1},L)}function h(){E?t("Page reset ignored by init"):(t("Page size reset by host page"),N("resetPage"))}function g(){u("resizeParent","Parent window requested size check")}function o(){var t=n();v.findTarget(t)}function s(){return i.data.split("]")[1].split(":")[0]}function n(){return i.data.substr(i.data.indexOf(":")+1)}function r(){return"iFrameResize"in e}function f(){var e=n();t("MessageCallback called from parent: "+e),z(JSON.parse(e)),t(" --")}function p(){var e=n();t("PageInfoFromParent called from parent: "+e),F(JSON.parse(e)),t(" --")}function a(){return i.data.split(":")[2]in{true:1,false:1}}function m(){switch(s()){case"reset":h();break;case"resize":g();break;case"moveToAnchor":o();break;case"message":f();break;case"pageInfo":p();break;default:r()||a()||d("Unexpected message ("+i.data+")")}}function b(){!1===ct?m():a()?l():t('Ignored message of type "'+s()+'". Received before initialization.')}c()&&b()}function zt(){"loading"!==o.readyState&&e.parent.postMessage("[iFrameResizerChild]Ready","*")}var r=!0,Q=10,tt="",I=0,S="",M=null,rt="",b=!1,xt={resize:1,click:1},L=128,ct=!0,f=1,O="bodyOffset",n=O,E=!0,D="",v={},h=32,j=null,J=!1,H="[iFrameSizer]",X=H.length,T="",V={max:1,min:1,bodyScroll:1,documentElementScroll:1},$="child",G=!0,Z=e.parent,m="*",A=0,x=!1,it=null,g=16,p=1,at="scroll",s=at,$t=e,z=function(){d("MessageCallback function not defined")},R=function(){},F=function(){},_=Date.now||function(){return(new Date).getTime()},l={bodyOffset:function(){return o.body.offsetHeight+k("marginTop")+k("marginBottom")},offset:function(){return l.bodyOffset()},bodyScroll:function(){return o.body.scrollHeight},documentElementOffset:function(){return o.documentElement.offsetHeight},documentElementScroll:function(){return o.documentElement.scrollHeight},max:function(){return Math.max.apply(null,y(l))},min:function(){return Math.min.apply(null,y(l))},grow:function(){return l.max()},lowestElement:function(){return Math.max(l.bodyOffset(),P("bottom",st()))},taggedElement:function(){return nt("bottom","data-iframe-height")}},c={bodyScroll:function(){return o.body.scrollWidth},bodyOffset:function(){return o.body.offsetWidth},documentElementScroll:function(){return o.documentElement.scrollWidth},documentElementOffset:function(){return o.documentElement.offsetWidth},scroll:function(){return Math.max(c.bodyScroll(),c.documentElementScroll())},max:function(){return Math.max.apply(null,y(c))},min:function(){return Math.min.apply(null,y(c))},rightMostElement:function(){return P("right",st())},taggedElement:function(){return nt("right","data-iframe-width")}},Ct=vt(Mt);w(e,"message",Y),zt()}(n||{}),define("fill_the_gaps/fill_the_gaps",[ie],function(e){var t=e[si](Rn);return t.defaultReset=!1,t[st]=function(){this.proto[st].call(this,zn),this[O](this[st])},t[at]=function(){this.proto[at].apply(this,arguments),this._values=[],this[O](this[at]),this[$e](!0)},t[$e]=function(t){this[O](this[$e])},t[A]=function(t,e){this.content.children().autoTextSize(this._autoSize),this[O](this[A],t,e)},t[bt]=function(t){return this[O](this[bt],t)},t.checkReset=function(){this.proto.checkReset.call(this,this[O](this.checkReset))},t.checkSubmit=function(){this.proto.checkSubmit.call(this,this[O](this.checkSubmit))},t[ct]=function(){this[O](this[ct]),this.content.children().autoTextSize(this._autoSize)},t[tt]=function(){this.proto[tt].call(this),this[O](this[tt])},t[G]=function(){this.proto[G].call(this),this[O](this[G])},t}),require(["velocity-ui","velocity","modernizr","jquery","api","common","_const","activity","fill_the_gaps/fill_the_gaps.dropdown","iframeResizer","fill_the_gaps/fill_the_gaps"])}(document,window);